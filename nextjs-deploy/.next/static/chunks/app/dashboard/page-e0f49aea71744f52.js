(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{5458:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]])},5119:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},3086:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]])},9136:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},8784:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},261:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]])},9934:function(e,t,r){Promise.resolve().then(r.bind(r,227))},227:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return OverviewDashboard}});var n=r(7437),s=r(2265),i=r(307),l=r(5217),a=r(5119),o=r(5458),c=r(261),d=r(8784),u=r(316),f=r(1897),m=r(8772),x=r(9598),h=r(1750),g=r(4631),b=r(5887);function OverviewDashboard(){let e,t;let[r,p]=(0,s.useState)([]),[v,y]=(0,s.useState)(null),[j,N]=(0,s.useState)({});(0,s.useEffect)(()=>{let e=(0,g.k)();if(!e)return;let handleMessage=(e,t)=>{try{let r=JSON.parse(t.toString());if("response_device_modbus"===e&&Array.isArray(r)&&p(r),"batteryCharger"===e&&y(r),"modbus_snmp_summ"===e){let e=r["MODBUS SNMP STATUS"];if("string"==typeof e){let t=e.match(/^(.*?)\s+(.+?)$/);if(t){let e=t[1],r=t[2];N(t=>({...t,[e]:r}))}}}}catch(e){console.error("[MQTT] Invalid JSON:",e)}};return e.on("message",handleMessage),e.subscribe("response_device_modbus"),e.subscribe("batteryCharger"),e.subscribe("modbus_snmp_summ"),e.publish("command_device_modbus",JSON.stringify({command:"getDataModbus"})),()=>{e.unsubscribe("response_device_modbus"),e.unsubscribe("batteryCharger"),e.unsubscribe("modbus_snmp_summ"),e.off("message",handleMessage)}},[]);let w=(e=0,t=0,r.forEach(r=>{var n;let s=j[null===(n=r.profile)||void 0===n?void 0:n.name];(null==s?void 0:s.includes("success"))?e++:t++}),{online:e,offline:t}),k=r.length,M=w.online,T=w.offline;return(0,n.jsxs)(i.kV,{children:[(0,n.jsxs)("header",{className:"flex h-16 shrink-0 items-center gap-2 border-b px-4",children:[(0,n.jsx)(i.vP,{className:"-ml-1"}),(0,n.jsx)(l.Z,{orientation:"vertical",className:"mr-2 h-4"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(a.Z,{className:"h-5 w-5"}),(0,n.jsx)("h1",{className:"text-lg font-semibold",children:"Node App"})]}),(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[!(0,b.d)()&&(0,n.jsx)(u.Z,{}),(0,n.jsx)(f.Z,{})]})]}),(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-4 p-4",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,n.jsxs)(x.Zb,{children:[(0,n.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,n.jsx)(x.ll,{className:"text-sm font-medium",children:"Total Devices"}),(0,n.jsx)(o.Z,{className:"h-5 w-5 text-muted-foreground"})]}),(0,n.jsxs)(x.aY,{children:[(0,n.jsx)("div",{className:"text-2xl font-bold",children:k}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"All registered devices"})]})]}),(0,n.jsxs)(x.Zb,{children:[(0,n.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,n.jsx)(x.ll,{className:"text-sm font-medium",children:"Online"}),(0,n.jsx)(c.Z,{className:"h-5 w-5 text-green-500"})]}),(0,n.jsxs)(x.aY,{children:[(0,n.jsx)("div",{className:"text-2xl font-bold",children:M}),(0,n.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"Devices currently online"}),k===M&&k>0&&(0,n.jsx)("div",{className:"px-2 py-0.5 rounded-full bg-green-100 text-green-600 text-xs font-medium border border-green-300",children:"All devices is Online"})]})]})]}),(0,n.jsxs)(x.Zb,{children:[(0,n.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,n.jsx)(x.ll,{className:"text-sm font-medium",children:"Offline"}),(0,n.jsx)(d.Z,{className:"h-5 w-5 text-red-500"})]}),(0,n.jsxs)(x.aY,{children:[(0,n.jsx)("div",{className:"text-2xl font-bold",children:T}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"Devices currently offline"})]})]})]}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsxs)(h.mQ,{defaultValue:"modbus",className:"w-full",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(h.dr,{children:[(0,n.jsx)(h.SP,{value:"modbus",children:"Device Modbus/SNMP"}),(0,n.jsx)(h.SP,{value:"battery",children:"Battery Charger"})]}),(0,n.jsx)(m.Z,{})]}),(0,n.jsx)(h.nU,{value:"modbus",className:"mt-2",children:(0,n.jsxs)(x.Zb,{children:[(0,n.jsxs)(x.Ol,{children:[(0,n.jsx)(x.ll,{children:"Device Modbus/SNMP"}),(0,n.jsx)(x.SZ,{children:"List of Modbus/SNMP devices"})]}),(0,n.jsx)(x.aY,{className:"text-sm text-muted-foreground",children:0===r.length?(0,n.jsx)("div",{children:"No Modbus/SNMP devices found."}):(0,n.jsx)("ul",{className:"space-y-2",children:r.map((e,t)=>{var r,s,i,l,a,o,c,d,u,f,m;return(0,n.jsxs)("li",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between border-b pb-2 last:border-b-0 last:pb-0",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-semibold",children:null===(r=e.profile)||void 0===r?void 0:r.name})," ",(0,n.jsxs)("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",null===(s=e.profile)||void 0===s?void 0:s.part_number,")"]}),(0,n.jsx)("div",{className:"text-xs",children:(null===(i=e.protocol_setting)||void 0===i?void 0:i.protocol)==="Modbus RTU"?"Address: ".concat(null===(l=e.protocol_setting)||void 0===l?void 0:l.address):"IP: ".concat(null===(a=e.protocol_setting)||void 0===a?void 0:a.ip_address)}),(0,n.jsxs)("div",{className:"text-xs",children:["Topic: ",null===(o=e.profile)||void 0===o?void 0:o.topic]})]}),(0,n.jsx)("span",{className:"text-xs font-semibold ml-2 ".concat((null===(c=j[null===(d=e.profile)||void 0===d?void 0:d.name])||void 0===c?void 0:c.includes("success"))?"text-green-600 bg-green-200 rounded-full px-2 py-1":"text-red-600 bg-red-200 rounded-full px-2 py-1"),children:(null===(u=j[null===(f=e.profile)||void 0===f?void 0:f.name])||void 0===u?void 0:u.includes("success"))?"Online":"Offline"})]},(null===(m=e.profile)||void 0===m?void 0:m.name)||t)})})})]})}),(0,n.jsx)(h.nU,{value:"battery",className:"mt-2",children:(0,n.jsxs)(x.Zb,{children:[(0,n.jsxs)(x.Ol,{children:[(0,n.jsx)(x.ll,{children:"Battery Charger"}),(0,n.jsx)(x.SZ,{children:"Live data from charger via MQTT"})]}),(0,n.jsx)(x.aY,{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:v?Object.entries(v).map(e=>{let[t,r]=e;return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-semibold",children:t}),(0,n.jsx)("div",{className:"text-muted-foreground",children:String(r)})]},t)}):(0,n.jsx)("div",{className:"col-span-full text-center",children:"Waiting for battery data..."})})]})})]})})]})]})}},8772:function(e,t,r){"use strict";r.d(t,{Z:function(){return MQTTConnectionBadge}});var n=r(7437),s=r(9035),i=r(708),l=r(5531);let a=(0,l.Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var o=r(9136);let c=(0,l.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var d=r(3715);function MQTTConnectionBadge(){let e=(0,s.w)(),{color:t,icon:r,label:l}=(()=>{switch(e){case"connected":return{color:"bg-green-500",icon:(0,n.jsx)(a,{className:"w-4 h-4 mr-1"}),label:"Connected"};case"disconnected":return{color:"bg-yellow-500",icon:(0,n.jsx)(o.Z,{className:"w-4 h-4 mr-1"}),label:"Disconnected"};case"error":return{color:"bg-red-500",icon:(0,n.jsx)(c,{className:"w-4 h-4 mr-1"}),label:"Error"};default:return{color:"bg-gray-400",icon:(0,n.jsx)(d.Z,{className:"w-4 h-4 mr-1 animate-spin"}),label:"Connecting..."}}})();return(0,n.jsxs)(i.C,{className:"flex items-center ".concat(t," text-white px-2 py-1"),children:[r,(0,n.jsx)("span",{className:"text-sm",children:l})]})}},316:function(e,t,r){"use strict";r.d(t,{Z:function(){return RealtimeClockWithRefresh}});var n=r(7437),s=r(2265);function getCurrentTime(){let e=new Date,t=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),r=e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return"".concat(r," - ").concat(t)}function RealtimeClockWithRefresh(){let[e,t]=(0,s.useState)(""),[r,i]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{i(!0);let e=setInterval(()=>{t(getCurrentTime())},1e3);return()=>clearInterval(e)},[]),r)?(0,n.jsx)("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:(0,n.jsx)("span",{children:e})}):null}},1897:function(e,t,r){"use strict";r.d(t,{Z:function(){return Refresh}});var n=r(7437),s=r(3086),i=r(3611);function Refresh(){return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(i.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>window.location.reload(),title:"Refresh halaman",children:(0,n.jsx)(s.Z,{className:"h-4 w-4"})})})}},708:function(e,t,r){"use strict";r.d(t,{C:function(){return Badge}});var n=r(7437);r(2265);var s=r(6061),i=r(1628);let l=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-400 text-yellow-900 hover:bg-yellow-500",outline:"bg-transparent border-foreground text-foreground",outlineInfo:"bg-transparent border-blue-500 text-blue-600",outlineSuccess:"bg-transparent border-green-500 text-green-600",outlineWarning:"bg-transparent border-yellow-400 text-yellow-700",outlineDestructive:"bg-transparent border-destructive text-destructive",gradientInfo:"border-0 bg-gradient-to-r from-blue-400/50 to-blue-600/50 text-blue-900",gradientSuccess:"border-0 bg-gradient-to-r from-green-400/50 to-green-600/50 text-green-900",gradientWarning:"border-0 bg-gradient-to-r from-yellow-300/50 to-yellow-500/50 text-yellow-900",gradientDestructive:"border-0 bg-gradient-to-r from-red-400/50 to-red-600/50 text-red-900"}},defaultVariants:{variant:"default"}});function Badge(e){let{className:t,variant:r,...s}=e;return(0,n.jsx)("div",{className:(0,i.cn)(l({variant:r}),t),...s})}},9598:function(e,t,r){"use strict";r.d(t,{Ol:function(){return a},SZ:function(){return c},Zb:function(){return l},aY:function(){return d},eW:function(){return u},ll:function(){return o}});var n=r(7437),s=r(2265),i=r(1628);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});l.displayName="Card";let a=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...s})});a.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});o.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},1750:function(e,t,r){"use strict";r.d(t,{SP:function(){return c},dr:function(){return o},mQ:function(){return a},nU:function(){return d}});var n=r(7437),s=r(2265),i=r(7094),l=r(1628);let a=i.fC,o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(i.aV,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...s})});o.displayName=i.aV.displayName;let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(i.xz,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...s})});c.displayName=i.xz.displayName;let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(i.VY,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...s})});d.displayName=i.VY.displayName},9035:function(e,t,r){"use strict";r.d(t,{w:function(){return useMQTTStatus}});var n=r(2265),s=r(4631);function useMQTTStatus(){let[e,t]=(0,n.useState)("connecting");return(0,n.useEffect)(()=>{let e=(0,s.k)(),handleConnect=()=>{console.log("✅ Connected to MQTT"),t("connected")},handleError=e=>{console.error("❌ MQTT Error",e),t("error")},handleClose=()=>{console.warn("⚠️ MQTT Disconnected"),t("disconnected")};return e.on("connect",handleConnect),e.on("error",handleError),e.on("close",handleClose),()=>{e.off("connect",handleConnect),e.off("error",handleError),e.off("close",handleClose)}},[]),e}},4631:function(e,t,r){"use strict";r.d(t,{O:function(){return getMQTTClient},k:function(){return connectMQTT}});var n=r(7406);let s=null;function connectMQTT(){let e="ws://localhost:9000";if(!e)throw Error("MQTT broker URL tidak didefinisikan di .env");return(!s||s.disconnected)&&(s=n.Z.connect(e,{clean:!0,connectTimeout:4e3,reconnectPeriod:1e3})),s}function getMQTTClient(){return s}}},function(e){e.O(0,[2793,9848,5348,6099,307,2971,2472,1744],function(){return e(e.s=9934)}),_N_E=e.O()}]);