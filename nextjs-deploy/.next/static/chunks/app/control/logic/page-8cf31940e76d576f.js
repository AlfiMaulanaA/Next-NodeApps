(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1792],{9209:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var n=t(5531);let s=(0,n.Z)("file-chart-column-increasing",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]])},4136:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var n=t(5531);let s=(0,n.Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},3086:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var n=t(5531);let s=(0,n.Z)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]])},5367:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var n=t(5531);let s=(0,n.Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},3930:function(e,r,t){Promise.resolve().then(t.bind(t,1592))},1592:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return LogicControlPage}});var n=t(7437),s=t(2265),a=t(708),o=t(3611),c=t(9598),i=t(5217),d=t(307),l=t(9209),u=t(3086),f=t(4136),g=t(5367),m=t(4631),x=t(1424);function LogicControlPage(){let[e,r]=(0,s.useState)([]),[t,b]=(0,s.useState)("disconnected"),p=(0,m.k)();(0,s.useEffect)(()=>{if(!p)return;let handleMessage=(e,t)=>{try{let n=JSON.parse(t.toString());"response_get_data"===e?r(n.data.read_data||[]):"response_control_drycontact"===e?"success"===n.status?(x.Am.success(n.message),refreshData(),restartService()):x.Am.error(n.message):"service/response"===e&&("success"===n.result?x.Am.success(n.message):x.Am.error(n.message))}catch(e){console.error("Failed to parse MQTT message",e),x.Am.error("MQTT parsing error")}};return p.on("message",handleMessage),p.subscribe("response_get_data"),p.subscribe("response_control_drycontact"),p.subscribe("service/response"),b("connected"),refreshData(),()=>{p.unsubscribe("response_get_data"),p.unsubscribe("response_control_drycontact"),p.unsubscribe("service/response"),p.off("message",handleMessage)}},[p]);let refreshData=()=>{null==p||p.publish("command_control_drycontact",JSON.stringify({action:"get"}))},deleteConfig=e=>{null==p||p.publish("command_control_drycontact",JSON.stringify({command:"delete",data:{id:e}})),x.Am.success("Configuration deleted"),restartService()},restartService=()=>{let e=JSON.stringify({action:"restart",services:["modular_i2c.service","drycontact_control.service"]});null==p||p.publish("service/command",e)};return(0,n.jsxs)(d.kV,{children:[(0,n.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(d.vP,{className:"-ml-1"}),(0,n.jsx)(i.Z,{orientation:"vertical",className:"mr-2 h-4"}),(0,n.jsx)(l.Z,{className:"h-5 w-5 text-muted-foreground"}),(0,n.jsx)("h1",{className:"text-lg font-semibold",children:"Logic Control Configurations"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(a.C,{variant:"outline",className:"capitalize ".concat("connected"===t?"text-green-600 border-green-600":"error"===t?"text-red-600 border-red-600":"text-yellow-600 border-yellow-600"),children:t}),(0,n.jsx)(o.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:refreshData,children:(0,n.jsx)(u.Z,{})})]})]}),(0,n.jsx)("div",{className:"p-4 space-y-4",children:e.length>0?e.map((e,r)=>(0,n.jsxs)(c.Zb,{children:[(0,n.jsxs)(c.Ol,{children:[(0,n.jsxs)(c.ll,{className:"text-base",children:[r+1,". ",e.customName||"N/A"]}),(0,n.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Addr: ",e.address," — Bus: ",e.bus," — Pin: ",e.pin," — Expected: ",e.expected_value?"True":"False"]})]}),(0,n.jsxs)(c.aY,{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-sm font-medium",children:"Control Relays:"}),e.control_relays.map((e,r)=>(0,n.jsxs)("div",{className:"text-sm border rounded p-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:e.customName})," — Addr: ",e.address,", Bus: ",e.bus,", Pin: ",e.pin]}),(0,n.jsxs)("div",{children:["Set: ",e.set_value?"True":"False",", Type: ",e.control_type,", Delay: ",e.delay,"s, Latching: ",e.latching_mode?"Yes":"No"]})]},r)),(0,n.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,n.jsxs)(o.z,{size:"sm",variant:"outline",children:[(0,n.jsx)(f.Z,{className:"h-4 w-4 mr-1"})," Edit"]}),(0,n.jsxs)(o.z,{size:"sm",variant:"destructive",onClick:()=>deleteConfig(e.id),children:[(0,n.jsx)(g.Z,{className:"h-4 w-4 mr-1"})," Delete"]})]})]})]},e.id)):(0,n.jsx)(c.Zb,{children:(0,n.jsx)(c.aY,{className:"p-4 text-center text-muted-foreground",children:"No dry contact configurations found."})})})]})}},708:function(e,r,t){"use strict";t.d(r,{C:function(){return Badge}});var n=t(7437);t(2265);var s=t(6061),a=t(1628);let o=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-400 text-yellow-900 hover:bg-yellow-500",outline:"bg-transparent border-foreground text-foreground",outlineInfo:"bg-transparent border-blue-500 text-blue-600",outlineSuccess:"bg-transparent border-green-500 text-green-600",outlineWarning:"bg-transparent border-yellow-400 text-yellow-700",outlineDestructive:"bg-transparent border-destructive text-destructive",gradientInfo:"border-0 bg-gradient-to-r from-blue-400/50 to-blue-600/50 text-blue-900",gradientSuccess:"border-0 bg-gradient-to-r from-green-400/50 to-green-600/50 text-green-900",gradientWarning:"border-0 bg-gradient-to-r from-yellow-300/50 to-yellow-500/50 text-yellow-900",gradientDestructive:"border-0 bg-gradient-to-r from-red-400/50 to-red-600/50 text-red-900"}},defaultVariants:{variant:"default"}});function Badge(e){let{className:r,variant:t,...s}=e;return(0,n.jsx)("div",{className:(0,a.cn)(o({variant:t}),r),...s})}},9598:function(e,r,t){"use strict";t.d(r,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return o},aY:function(){return l},eW:function(){return u},ll:function(){return i}});var n=t(7437),s=t(2265),a=t(1628);let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});o.displayName="Card";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",t),...s})});c.displayName="CardHeader";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});i.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",t),...s})});l.displayName="CardContent";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",t),...s})});u.displayName="CardFooter"},4631:function(e,r,t){"use strict";t.d(r,{O:function(){return getMQTTClient},k:function(){return connectMQTT}});var n=t(7406);let s=null;function connectMQTT(){let e="ws://localhost:9000";if(!e)throw Error("MQTT broker URL tidak didefinisikan di .env");return(!s||s.disconnected)&&(s=n.Z.connect(e,{clean:!0,connectTimeout:4e3,reconnectPeriod:1e3})),s}function getMQTTClient(){return s}}},function(e){e.O(0,[2793,9848,5348,1424,307,2971,2472,1744],function(){return e(e.s=3930)}),_N_E=e.O()}]);