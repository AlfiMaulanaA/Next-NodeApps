(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4502],{3086:function(e,r,t){"use strict";t.d(r,{Z:function(){return o}});var n=t(5531);let o=(0,n.Z)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]])},2741:function(e,r,t){Promise.resolve().then(t.bind(t,6629))},6629:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return ModularDashboardPage}});var n=t(7437),o=t(2265),s=t(708),i=t(3611),l=t(9598),a=t(307),d=t(5531);let c=(0,d.Z)("sliders-horizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);var u=t(3086),f=t(5217),x=t(4631),g=t(9035);function ModularDashboardPage(){let[e,r]=(0,o.useState)([]),[t,d]=(0,o.useState)({}),[b,m]=(0,o.useState)({}),p=(0,g.w)(),v=(0,x.k)();(0,o.useEffect)(()=>{if(!v)return;let handleMessage=(e,t)=>{try{let n=JSON.parse(t.toString());Array.isArray(n)?r(n):(null==n?void 0:n.topic)&&d(r=>({...r,[e]:n}))}catch(e){console.error("Failed to parse MQTT message",e)}};return v.on("message",handleMessage),v.subscribe("response_device_i2c"),v.subscribe("device_data/#"),()=>{v.unsubscribe("response_device_i2c"),v.unsubscribe("device_data/#"),v.off("message",handleMessage)}},[v]);let toggleVisibility=e=>{e&&m(r=>({...r,[e]:!r[e]}))};return(0,n.jsxs)(a.kV,{children:[(0,n.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(a.vP,{className:"-ml-1"}),(0,n.jsx)(f.Z,{orientation:"vertical",className:"mr-2 h-4"}),(0,n.jsx)(c,{className:"h-5 w-5 text-muted-foreground"}),(0,n.jsx)("h1",{className:"text-lg font-semibold",children:"Modular Control Dashboard"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(s.C,{variant:"outline",className:"capitalize ".concat("connected"===p?"text-green-600 border-green-600":"error"===p?"text-red-600 border-red-600":"text-yellow-600 border-yellow-600"),children:p}),(0,n.jsx)(i.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{null==v||v.publish("command_device_i2c",JSON.stringify({command:"getDataI2C"}))},children:(0,n.jsx)(u.Z,{})})]})]}),(0,n.jsx)("div",{className:"p-4 space-y-4",children:e.length>0?e.map(e=>{var r,o,s,a,d,c,u,f;return(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)(l.Ol,{className:"flex flex-col gap-1",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)(l.ll,{className:"text-base",children:[null===(r=e.profile)||void 0===r?void 0:r.name," (",null===(o=e.profile)||void 0===o?void 0:o.part_number,")"]}),(0,n.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Addr: ",null===(s=e.protocol_setting)||void 0===s?void 0:s.address]})]}),(0,n.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,n.jsxs)("span",{children:["Topic: ",null===(a=e.profile)||void 0===a?void 0:a.topic]}),(0,n.jsx)(i.z,{size:"sm",variant:"ghost",onClick:()=>{var r;return toggleVisibility(null===(r=e.profile)||void 0===r?void 0:r.id)},children:b[(null===(d=e.profile)||void 0===d?void 0:d.id)||""]?"Hide":"Show"})]})]}),b[(null===(c=e.profile)||void 0===c?void 0:c.id)||""]&&(0,n.jsx)(l.aY,{className:"space-y-2 text-sm",children:(0,n.jsx)("pre",{className:"rounded bg-muted p-2 whitespace-pre-wrap",children:JSON.stringify(t[(null===(u=e.profile)||void 0===u?void 0:u.topic)||""],null,2)})})]},null===(f=e.profile)||void 0===f?void 0:f.id)}):(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"p-4 text-center text-muted-foreground",children:"No devices found. Click refresh to try again."})})})]})}},708:function(e,r,t){"use strict";t.d(r,{C:function(){return Badge}});var n=t(7437);t(2265);var o=t(6061),s=t(1628);let i=(0,o.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-400 text-yellow-900 hover:bg-yellow-500",outline:"bg-transparent border-foreground text-foreground",outlineInfo:"bg-transparent border-blue-500 text-blue-600",outlineSuccess:"bg-transparent border-green-500 text-green-600",outlineWarning:"bg-transparent border-yellow-400 text-yellow-700",outlineDestructive:"bg-transparent border-destructive text-destructive",gradientInfo:"border-0 bg-gradient-to-r from-blue-400/50 to-blue-600/50 text-blue-900",gradientSuccess:"border-0 bg-gradient-to-r from-green-400/50 to-green-600/50 text-green-900",gradientWarning:"border-0 bg-gradient-to-r from-yellow-300/50 to-yellow-500/50 text-yellow-900",gradientDestructive:"border-0 bg-gradient-to-r from-red-400/50 to-red-600/50 text-red-900"}},defaultVariants:{variant:"default"}});function Badge(e){let{className:r,variant:t,...o}=e;return(0,n.jsx)("div",{className:(0,s.cn)(i({variant:t}),r),...o})}},9598:function(e,r,t){"use strict";t.d(r,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},eW:function(){return u},ll:function(){return a}});var n=t(7437),o=t(2265),s=t(1628);let i=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...o})});i.displayName="Card";let l=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",t),...o})});l.displayName="CardHeader";let a=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",t),...o})});a.displayName="CardTitle";let d=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",t),...o})});d.displayName="CardDescription";let c=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",t),...o})});c.displayName="CardContent";let u=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",t),...o})});u.displayName="CardFooter"},9035:function(e,r,t){"use strict";t.d(r,{w:function(){return useMQTTStatus}});var n=t(2265),o=t(4631);function useMQTTStatus(){let[e,r]=(0,n.useState)("connecting");return(0,n.useEffect)(()=>{let e=(0,o.k)(),handleConnect=()=>{console.log("✅ Connected to MQTT"),r("connected")},handleError=e=>{console.error("❌ MQTT Error",e),r("error")},handleClose=()=>{console.warn("⚠️ MQTT Disconnected"),r("disconnected")};return e.on("connect",handleConnect),e.on("error",handleError),e.on("close",handleClose),()=>{e.off("connect",handleConnect),e.off("error",handleError),e.off("close",handleClose)}},[]),e}},4631:function(e,r,t){"use strict";t.d(r,{O:function(){return getMQTTClient},k:function(){return connectMQTT}});var n=t(7406);let o=null;function connectMQTT(){let e="ws://localhost:9000";if(!e)throw Error("MQTT broker URL tidak didefinisikan di .env");return(!o||o.disconnected)&&(o=n.Z.connect(e,{clean:!0,connectTimeout:4e3,reconnectPeriod:1e3})),o}function getMQTTClient(){return o}}},function(e){e.O(0,[2793,9848,5348,307,2971,2472,1744],function(){return e(e.s=2741)}),_N_E=e.O()}]);