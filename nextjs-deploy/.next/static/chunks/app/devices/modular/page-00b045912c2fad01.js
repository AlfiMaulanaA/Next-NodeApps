(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[172],{5458:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var l=t(5531);let n=(0,l.Z)("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]])},3086:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var l=t(5531);let n=(0,l.Z)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]])},1204:function(e,s,t){Promise.resolve().then(t.bind(t,2706))},2706:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return DeviceManagerPage}});var l=t(7437),n=t(2265),r=t(708),i=t(3611),a=t(6005),d=t(9598),c=t(5831),o=t(690),h=t(2031),x=t(307),u=t(5458),p=t(3086),m=t(5531);let f=(0,m.Z)("microchip",[["path",{d:"M18 12h2",key:"quuxs7"}],["path",{d:"M18 16h2",key:"zsn3lv"}],["path",{d:"M18 20h2",key:"9x5y9y"}],["path",{d:"M18 4h2",key:"1luxfb"}],["path",{d:"M18 8h2",key:"nxqzg"}],["path",{d:"M4 12h2",key:"1ltxp0"}],["path",{d:"M4 16h2",key:"8a5zha"}],["path",{d:"M4 20h2",key:"27dk57"}],["path",{d:"M4 4h2",key:"10groj"}],["path",{d:"M4 8h2",key:"18vq6w"}],["path",{d:"M8 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-1.5c-.276 0-.494.227-.562.495a2 2 0 0 1-3.876 0C9.994 2.227 9.776 2 9.5 2z",key:"1681fp"}]]),j=(0,m.Z)("unplug",[["path",{d:"m19 5 3-3",key:"yk6iyv"}],["path",{d:"m2 22 3-3",key:"19mgm9"}],["path",{d:"M6.3 20.3a2.4 2.4 0 0 0 3.4 0L12 18l-6-6-2.3 2.3a2.4 2.4 0 0 0 0 3.4Z",key:"goz73y"}],["path",{d:"M7.5 13.5 10 11",key:"7xgeeb"}],["path",{d:"M10.5 16.5 13 14",key:"10btkg"}],["path",{d:"m12 6 6 6 2.3-2.3a2.4 2.4 0 0 0 0-3.4l-2.6-2.6a2.4 2.4 0 0 0-3.4 0Z",key:"1snsnr"}]]);var v=t(4196),g=t(5217),N=t(6820),y=t.n(N),b=t(4631),k=t(9035),_=t(9652),C=t(9719),M=t(8965),w=t(7532);function DeviceManagerPage(){let[e,s]=(0,n.useState)([]),[t,m]=(0,n.useState)(!1),[N,D]=(0,n.useState)(!1),[O,Z]=(0,n.useState)(1),[S,A]=(0,n.useState)({profile:{name:"",part_number:"",topic:""},protocol_setting:{address:"",device_bus:""}}),I=(0,k.w)(),z=(0,b.k)();(0,n.useEffect)(()=>{if(!z)return;let handleMessage=(e,t)=>{try{let e=JSON.parse(t.toString());Array.isArray(e)&&(console.log(e),s(e),console.log(e))}catch(e){console.error("Invalid JSON from MQTT",e)}};return z.on("message",handleMessage),z.subscribe("response_device_i2c"),z.publish("command_device_i2c",JSON.stringify({command:"getDataI2C"})),()=>{z.unsubscribe("response_device_i2c"),z.off("message",handleMessage)}},[z]);let handleDelete=e=>{y().fire({title:"Delete ".concat(e,"?"),text:"You can't undo this!",icon:"warning",showCancelButton:!0}).then(s=>{if(s.isConfirmed){let s=JSON.stringify({command:"deleteDevice",name:e});null==z||z.publish("command_device_i2c",s)}})},{sorted:R,sortField:T,sortDirection:L,handleSort:Y}=(0,_.E)(e),{searchQuery:E,setSearchQuery:P,filteredData:q}=(0,C.d)(R,["profile.name","profile.part_number","profile.topic","protocol_setting.address"]),J=Math.ceil(q.length/5),Q=q.slice((O-1)*5,5*O);return(0,l.jsxs)(x.kV,{children:[(0,l.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(x.vP,{className:"-ml-1"}),(0,l.jsx)(g.Z,{orientation:"vertical",className:"mr-2 h-4"}),(0,l.jsx)(u.Z,{className:"h-5 w-5 text-muted-foreground"}),(0,l.jsx)("h1",{className:"text-lg font-semibold",children:"Modular Devices"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(r.C,{variant:"outline",className:"capitalize ".concat("connected"===I?"text-green-600 border-green-600":"error"===I?"text-red-600 border-red-600":"text-yellow-600 border-yellow-600"),children:I}),(0,l.jsx)(i.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>null==z?void 0:z.publish("command_device_i2c",JSON.stringify({command:"getDataI2C"})),children:(0,l.jsx)(p.Z,{})}),(0,l.jsx)(i.z,{size:"sm",variant:"default",onClick:()=>{A({profile:{name:"",part_number:"",topic:""},protocol_setting:{address:"",device_bus:""}}),D(!1),m(!0)},children:"Add Device"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 p-4",children:[(0,l.jsxs)(d.Zb,{children:[(0,l.jsx)(d.Ol,{children:(0,l.jsx)(d.ll,{children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{children:"Total Device"}),(0,l.jsx)("span",{className:"bg-blue-100 text-blue-700 rounded px-2 py-0.5 text-xs font-medium",children:"Summary"})]}),(0,l.jsx)(f,{className:"text-muted-foreground w-5 h-5"})]})})}),(0,l.jsxs)(d.aY,{children:[(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Registered Devices"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:e.length})]})]}),(0,l.jsxs)(d.Zb,{children:[(0,l.jsx)(d.Ol,{children:(0,l.jsx)(d.ll,{children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{children:"Device Status"}),(0,l.jsx)("span",{className:"bg-green-100 text-green-700 rounded px-2 py-0.5 text-xs font-medium",children:"Online/Offline"})]}),(0,l.jsx)(j,{className:"text-muted-foreground w-5 h-5"})]})})}),(0,l.jsx)(d.aY,{children:(0,l.jsxs)("div",{className:"flex items-center gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Online"}),(0,l.jsx)("p",{className:"text-xl font-semibold text-green-600",children:e.filter(e=>{var s;return(null===(s=e.status)||void 0===s?void 0:s.toLowerCase())==="online"}).length})]}),(0,l.jsx)("span",{className:"text-muted-foreground text-lg font-light",children:"/"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Offline"}),(0,l.jsx)("p",{className:"text-xl font-semibold text-red-600",children:e.filter(e=>{var s;return(null===(s=e.status)||void 0===s?void 0:s.toLowerCase())==="offline"}).length})]})]})})]}),(0,l.jsxs)(d.Zb,{children:[(0,l.jsx)(d.Ol,{children:(0,l.jsx)(d.ll,{children:"Top Device Type"})}),(0,l.jsxs)(d.aY,{children:[(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Most Common"}),(()=>{let s={};e.forEach(e=>{var t;let l=(null===(t=e.profile)||void 0===t?void 0:t.part_number)||"Unknown";s[l]=(s[l]||0)+1});let t=Object.entries(s).sort((e,s)=>s[1]-e[1])[0];return(0,l.jsxs)("p",{className:"text-xl font-semibold",children:[null==t?void 0:t[0]," (",null==t?void 0:t[1],")"]})})()]})]})]}),(0,l.jsxs)(d.Zb,{className:"m-4",children:[(0,l.jsx)(d.Ol,{children:(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)(d.ll,{children:"Device List"}),(0,l.jsx)(c.I,{placeholder:"Search devices...",value:E,onChange:e=>P(e.target.value),className:"h-8 w-64"})]})}),(0,l.jsxs)(d.aY,{children:[(0,l.jsxs)(a.iA,{children:[(0,l.jsx)(a.xD,{children:(0,l.jsxs)(a.SC,{children:[(0,l.jsx)(a.ss,{children:"#"}),(0,l.jsxs)(a.ss,{onClick:()=>Y("profile"),children:["Device Name ",(0,l.jsx)(v.Z,{className:"inline mr-1 h-4 w-4"})]}),(0,l.jsxs)(a.ss,{onClick:()=>Y("part_number"),children:["PN ",(0,l.jsx)(v.Z,{className:"inline mr-1 h-4 w-4"})]}),(0,l.jsxs)(a.ss,{onClick:()=>Y("address"),children:["Address ",(0,l.jsx)(v.Z,{className:"inline mr-1 h-4 w-4"})]}),(0,l.jsxs)(a.ss,{onClick:()=>Y("topic"),children:["Topic ",(0,l.jsx)(v.Z,{className:"inline mr-1 h-4 w-4"})]}),(0,l.jsx)(a.ss,{className:"text-right",children:"Action"})]})}),(0,l.jsx)(a.RM,{children:Q.length>0?Q.map((e,s)=>{var t,n,r,d,c;return(0,l.jsxs)(a.SC,{children:[(0,l.jsx)(a.pj,{children:(O-1)*5+s+1}),(0,l.jsx)(a.pj,{children:null===(t=e.profile)||void 0===t?void 0:t.name}),(0,l.jsx)(a.pj,{children:null===(n=e.profile)||void 0===n?void 0:n.part_number}),(0,l.jsx)(a.pj,{children:null===(r=e.protocol_setting)||void 0===r?void 0:r.address}),(0,l.jsx)(a.pj,{children:null===(d=e.profile)||void 0===d?void 0:d.topic}),(0,l.jsxs)(a.pj,{className:"text-right space-x-2",children:[(0,l.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>{A(e),D(!0),m(!0)},children:"Edit"}),(0,l.jsx)(i.z,{size:"sm",variant:"destructive",onClick:()=>{var s;return handleDelete(null===(s=e.profile)||void 0===s?void 0:s.name)},children:"Delete"})]})]},null===(c=e.profile)||void 0===c?void 0:c.name)}):(0,l.jsx)(a.SC,{children:(0,l.jsx)(a.pj,{colSpan:6,className:"text-center",children:"No devices found."})})})]}),(0,l.jsx)(M.tl,{className:"mt-4",children:(0,l.jsxs)(M.ng,{children:[(0,l.jsx)(M.nt,{children:(0,l.jsx)(M.dN,{onClick:()=>Z(e=>Math.max(e-1,1)),href:"#"})}),Array.from({length:J},(e,s)=>(0,l.jsx)(M.nt,{children:(0,l.jsx)(M.kN,{isActive:O===s+1,onClick:()=>Z(s+1),href:"#",children:s+1})},s)),(0,l.jsx)(M.nt,{children:(0,l.jsx)(M.$0,{onClick:()=>Z(e=>Math.min(e+1,J)),href:"#"})})]})})]})]}),(0,l.jsx)(h.Vq,{open:t,onOpenChange:m,children:(0,l.jsxs)(h.cZ,{children:[(0,l.jsx)(h.fK,{children:(0,l.jsx)(h.$N,{children:N?"Update Device":"Add New Device"})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(o._,{children:"Device Name"}),(0,l.jsx)(c.I,{value:S.profile.name,onChange:e=>A({...S,profile:{...S.profile,name:e.target.value}})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(o._,{children:"Part Number"}),(0,l.jsxs)(w.Ph,{value:S.profile.part_number,onValueChange:e=>A({...S,profile:{...S.profile,part_number:e}}),children:[(0,l.jsx)(w.i4,{children:(0,l.jsx)(w.ki,{placeholder:"Select a part number"})}),(0,l.jsxs)(w.Bw,{children:[(0,l.jsx)(w.Ql,{value:"RELAYMINI",children:"RELAYMINI"}),(0,l.jsx)(w.Ql,{value:"RELAY",children:"RELAY"}),(0,l.jsx)(w.Ql,{value:"DRYCONTACT",children:"DRYCONTACT"}),(0,l.jsx)(w.Ql,{value:"DIGITALIO",children:"DIGITAL IO"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(o._,{children:"Address"}),(0,l.jsx)(c.I,{value:S.protocol_setting.address,onChange:e=>A({...S,protocol_setting:{...S.protocol_setting,address:e.target.value}})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(o._,{children:"Device Bus"}),(0,l.jsx)(c.I,{value:S.protocol_setting.device_bus,onChange:e=>A({...S,protocol_setting:{...S.protocol_setting,device_bus:e.target.value}})})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[(0,l.jsx)(o._,{children:"Topic"}),(0,l.jsx)(c.I,{value:S.profile.topic,onChange:e=>A({...S,profile:{...S.profile,topic:e.target.value}})})]}),(0,l.jsx)(i.z,{onClick:()=>{let e=JSON.stringify({command:N?"updateDevice":"addDevice",device:S});null==z||z.publish("command_device_i2c",e),m(!1)},className:"col-span-2",children:N?"Update Device":"Add Device"})]})]})})]})}},9598:function(e,s,t){"use strict";t.d(s,{Ol:function(){return a},SZ:function(){return c},Zb:function(){return i},aY:function(){return o},eW:function(){return h},ll:function(){return d}});var l=t(7437),n=t(2265),r=t(1628);let i=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});i.displayName="Card";let a=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...n})});a.displayName="CardHeader";let d=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});d.displayName="CardTitle";let c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",t),...n})});c.displayName="CardDescription";let o=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",t),...n})});o.displayName="CardContent";let h=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",t),...n})});h.displayName="CardFooter"},690:function(e,s,t){"use strict";t.d(s,{_:function(){return o}});var l=t(7437),n=t(2265),r=t(9790),i=n.forwardRef((e,s)=>(0,l.jsx)(r.WV.label,{...e,ref:s,onMouseDown:s=>{let t=s.target;t.closest("button, input, select, textarea")||(e.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));i.displayName="Label";var a=t(6061),d=t(1628);let c=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,l.jsx)(i,{ref:s,className:(0,d.cn)(c(),t),...n})});o.displayName=i.displayName}},function(e){e.O(0,[2793,9461,9848,5348,298,307,97,2971,2472,1744],function(){return e(e.s=1204)}),_N_E=e.O()}]);