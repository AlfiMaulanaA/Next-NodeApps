(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[274],{1392:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var n=s(5531);let a=(0,n.Z)("network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]])},4280:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var n=s(5531);let a=(0,n.Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},5505:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var n=s(5531);let a=(0,n.Z)("settings-2",[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]])},8844:function(e,t,s){Promise.resolve().then(s.bind(s,5049))},5049:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ModbusTCPPage}});var n=s(7437),a=s(2265),c=s(5831),r=s(3611),i=s(5217),d=s(307),o=s(1392),l=s(4280),u=s(5505),m=s(5531);let h=(0,m.Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var b=s(4829),p=s(4631);function ModbusTCPPage(){let[e,t]=(0,a.useState)(""),[s,m]=(0,a.useState)(""),[x,g]=(0,a.useState)(""),[f,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=(0,p.k)();return v(e),e.subscribe("IOT/Containment/modbustcp/setting/data"),e.subscribe("IOT/Containment/modbustcp/status"),e.on("message",(e,s)=>{let n=JSON.parse(s.toString());"IOT/Containment/modbustcp/setting/data"===e?(t(n.modbus_tcp_ip),m(n.modbus_tcp_port)):"IOT/Containment/modbustcp/status"===e&&g(n.modbusTCPStatus||"Unknown status")}),()=>{e.unsubscribe("IOT/Containment/modbustcp/setting/data"),e.unsubscribe("IOT/Containment/modbustcp/status"),e.end()}},[]);let requestModbusSettings=()=>{f&&f.publish("IOT/Containment/modbustcp/setting/command",JSON.stringify({command:"read"}))},restartService=async()=>{try{await b.Z.post("/api/restart-protocol"),alert("Service restarted successfully.")}catch(e){alert("Failed to restart service: "+e.message)}};return(0,n.jsxs)(d.kV,{children:[(0,n.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(d.vP,{className:"-ml-1"}),(0,n.jsx)(i.Z,{orientation:"vertical",className:"h-4"}),(0,n.jsx)(o.Z,{className:"w-5 h-5 text-primary"}),(0,n.jsx)("h1",{className:"text-lg font-semibold tracking-tight",children:"Modbus TCP Communication"})]}),(0,n.jsxs)(r.z,{variant:"outline",size:"sm",onClick:()=>{f&&f.publish("IOT/Containment/modbustcp/status/command",JSON.stringify({command:"check status"}))},children:[(0,n.jsx)(l.Z,{className:"w-4 h-4 mr-1"})," Check Status"]})]}),(0,n.jsxs)("div",{className:"p-6 space-y-8",children:[(0,n.jsxs)("section",{className:"bg-background shadow-md p-6 rounded-2xl border space-y-2",children:[(0,n.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,n.jsx)(u.Z,{className:"w-5 h-5"})," Modbus TCP Status"]}),(0,n.jsx)("p",{className:x?"text-green-600 bg-green-100 p-2 rounded font-bold":"text-red-500 bg-red-100 p-2 rounded font-bold",children:x||"No status available"})]}),(0,n.jsxs)("section",{className:"bg-background shadow-md p-6 rounded-2xl border space-y-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,n.jsx)(u.Z,{className:"w-5 h-5"})," Modbus TCP Settings"]}),(0,n.jsxs)(r.z,{size:"sm",variant:"secondary",onClick:requestModbusSettings,children:[(0,n.jsx)(l.Z,{className:"w-4 h-4 mr-1"})," Request"]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"IP Address"}),(0,n.jsx)(c.I,{value:e,onChange:e=>t(e.target.value),placeholder:"192.168.1.100"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Port"}),(0,n.jsx)(c.I,{type:"number",value:s,onChange:e=>m(Number(e.target.value)),placeholder:"502"})]})]}),(0,n.jsxs)(r.z,{className:"mt-4",onClick:()=>{f&&(f.publish("IOT/Containment/modbustcp/setting/command",JSON.stringify({command:"write",modbus_tcp_ip:e,modbus_tcp_port:s})),setTimeout(()=>{requestModbusSettings()},2e3),restartService())},children:[(0,n.jsx)(h,{className:"w-4 h-4 mr-2"})," Save Settings"]})]})]})]})}},4631:function(e,t,s){"use strict";s.d(t,{O:function(){return getMQTTClient},k:function(){return connectMQTT}});var n=s(7406);let a=null;function connectMQTT(){let e="ws://localhost:9000";if(!e)throw Error("MQTT broker URL tidak didefinisikan di .env");return(!a||a.disconnected)&&(a=n.Z.connect(e,{clean:!0,connectTimeout:4e3,reconnectPeriod:1e3})),a}function getMQTTClient(){return a}}},function(e){e.O(0,[2793,9848,5348,4829,307,2971,2472,1744],function(){return e(e.s=8844)}),_N_E=e.O()}]);