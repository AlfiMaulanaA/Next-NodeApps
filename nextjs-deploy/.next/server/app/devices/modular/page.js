(()=>{var e={};e.id=172,e.ids=[172],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},2706:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>d});var t=r(67096),i=r(16132),l=r(37284),n=r.n(l),a=r(32564),c={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>a[e]);r.d(s,c);let d=["",{children:["devices",{children:["modular",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,69415)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\devices\\modular\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,35345)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,38196)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,44293)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\not-found.tsx"]}],o=["D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\devices\\modular\\page.tsx"],x="/devices/modular/page",p={require:r,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/devices/modular/page",pathname:"/devices/modular",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},50757:(e,s,r)=>{Promise.resolve().then(r.bind(r,41821))},41821:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>DeviceManagerPage});var t=r(30784),i=r(9885),l=r(61890),n=r(95555),a=r(13422),c=r(20599),d=r(33770),o=r(32451),x=r(40516),p=r(31362),u=r(39423),h=r(41129),m=r(74740),j=r(63283),f=r(74050),g=r(73928),v=r(19300),N=r(92327),_=r(37640),b=r(94112),D=r(99491),C=r(47917),A=r(14723);function DeviceManagerPage(){let[e,s]=(0,i.useState)([]),[r,O]=(0,i.useState)(!1),[y,w]=(0,i.useState)(!1),[E,P]=(0,i.useState)(1),[q,T]=(0,i.useState)({profile:{name:"",part_number:"",topic:""},protocol_setting:{address:"",device_bus:""}}),I=(0,_.w)(),M=(0,N.k)();(0,i.useEffect)(()=>{if(!M)return;let handleMessage=(e,r)=>{try{let e=JSON.parse(r.toString());Array.isArray(e)&&(console.log(e),s(e),console.log(e))}catch(e){console.error("Invalid JSON from MQTT",e)}};return M.on("message",handleMessage),M.subscribe("response_device_i2c"),M.publish("command_device_i2c",JSON.stringify({command:"getDataI2C"})),()=>{M.unsubscribe("response_device_i2c"),M.off("message",handleMessage)}},[M]);let handleDelete=e=>{v.Z.fire({title:`Delete ${e}?`,text:"You can't undo this!",icon:"warning",showCancelButton:!0}).then(s=>{if(s.isConfirmed){let s=JSON.stringify({command:"deleteDevice",name:e});M?.publish("command_device_i2c",s)}})},{sorted:k,sortField:S,sortDirection:R,handleSort:L}=(0,b.E)(e),{searchQuery:Z,setSearchQuery:z,filteredData:Y}=(0,D.d)(k,["profile.name","profile.part_number","profile.topic","protocol_setting.address"]),V=Math.ceil(Y.length/5),G=Y.slice((E-1)*5,5*E);return(0,t.jsxs)(p.kV,{children:[(0,t.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(p.vP,{className:"-ml-1"}),t.jsx(g.Z,{orientation:"vertical",className:"mr-2 h-4"}),t.jsx(u.Z,{className:"h-5 w-5 text-muted-foreground"}),t.jsx("h1",{className:"text-lg font-semibold",children:"Modular Devices"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(l.C,{variant:"outline",className:`capitalize ${"connected"===I?"text-green-600 border-green-600":"error"===I?"text-red-600 border-red-600":"text-yellow-600 border-yellow-600"}`,children:I}),t.jsx(n.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>M?.publish("command_device_i2c",JSON.stringify({command:"getDataI2C"})),children:t.jsx(h.Z,{})}),t.jsx(n.z,{size:"sm",variant:"default",onClick:()=>{T({profile:{name:"",part_number:"",topic:""},protocol_setting:{address:"",device_bus:""}}),w(!1),O(!0)},children:"Add Device"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4 p-4",children:[(0,t.jsxs)(c.Zb,{children:[t.jsx(c.Ol,{children:t.jsx(c.ll,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:"Total Device"}),t.jsx("span",{className:"bg-blue-100 text-blue-700 rounded px-2 py-0.5 text-xs font-medium",children:"Summary"})]}),t.jsx(m.Z,{className:"text-muted-foreground w-5 h-5"})]})})}),(0,t.jsxs)(c.aY,{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Registered Devices"}),t.jsx("p",{className:"text-2xl font-bold",children:e.length})]})]}),(0,t.jsxs)(c.Zb,{children:[t.jsx(c.Ol,{children:t.jsx(c.ll,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:"Device Status"}),t.jsx("span",{className:"bg-green-100 text-green-700 rounded px-2 py-0.5 text-xs font-medium",children:"Online/Offline"})]}),t.jsx(j.Z,{className:"text-muted-foreground w-5 h-5"})]})})}),t.jsx(c.aY,{children:(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Online"}),t.jsx("p",{className:"text-xl font-semibold text-green-600",children:e.filter(e=>e.status?.toLowerCase()==="online").length})]}),t.jsx("span",{className:"text-muted-foreground text-lg font-light",children:"/"}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Offline"}),t.jsx("p",{className:"text-xl font-semibold text-red-600",children:e.filter(e=>e.status?.toLowerCase()==="offline").length})]})]})})]}),(0,t.jsxs)(c.Zb,{children:[t.jsx(c.Ol,{children:t.jsx(c.ll,{children:"Top Device Type"})}),(0,t.jsxs)(c.aY,{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Most Common"}),(()=>{let s={};e.forEach(e=>{let r=e.profile?.part_number||"Unknown";s[r]=(s[r]||0)+1});let r=Object.entries(s).sort((e,s)=>s[1]-e[1])[0];return(0,t.jsxs)("p",{className:"text-xl font-semibold",children:[r?.[0]," (",r?.[1],")"]})})()]})]})]}),(0,t.jsxs)(c.Zb,{className:"m-4",children:[t.jsx(c.Ol,{children:(0,t.jsxs)("div",{className:"flex justify-between",children:[t.jsx(c.ll,{children:"Device List"}),t.jsx(d.I,{placeholder:"Search devices...",value:Z,onChange:e=>z(e.target.value),className:"h-8 w-64"})]})}),(0,t.jsxs)(c.aY,{children:[(0,t.jsxs)(a.iA,{children:[t.jsx(a.xD,{children:(0,t.jsxs)(a.SC,{children:[t.jsx(a.ss,{children:"#"}),(0,t.jsxs)(a.ss,{onClick:()=>L("profile"),children:["Device Name ",t.jsx(f.Z,{className:"inline mr-1 h-4 w-4"})]}),(0,t.jsxs)(a.ss,{onClick:()=>L("part_number"),children:["PN ",t.jsx(f.Z,{className:"inline mr-1 h-4 w-4"})]}),(0,t.jsxs)(a.ss,{onClick:()=>L("address"),children:["Address ",t.jsx(f.Z,{className:"inline mr-1 h-4 w-4"})]}),(0,t.jsxs)(a.ss,{onClick:()=>L("topic"),children:["Topic ",t.jsx(f.Z,{className:"inline mr-1 h-4 w-4"})]}),t.jsx(a.ss,{className:"text-right",children:"Action"})]})}),t.jsx(a.RM,{children:G.length>0?G.map((e,s)=>(0,t.jsxs)(a.SC,{children:[t.jsx(a.pj,{children:(E-1)*5+s+1}),t.jsx(a.pj,{children:e.profile?.name}),t.jsx(a.pj,{children:e.profile?.part_number}),t.jsx(a.pj,{children:e.protocol_setting?.address}),t.jsx(a.pj,{children:e.profile?.topic}),(0,t.jsxs)(a.pj,{className:"text-right space-x-2",children:[t.jsx(n.z,{size:"sm",variant:"outline",onClick:()=>{T(e),w(!0),O(!0)},children:"Edit"}),t.jsx(n.z,{size:"sm",variant:"destructive",onClick:()=>handleDelete(e.profile?.name),children:"Delete"})]})]},e.profile?.name)):t.jsx(a.SC,{children:t.jsx(a.pj,{colSpan:6,className:"text-center",children:"No devices found."})})})]}),t.jsx(C.tl,{className:"mt-4",children:(0,t.jsxs)(C.ng,{children:[t.jsx(C.nt,{children:t.jsx(C.dN,{onClick:()=>P(e=>Math.max(e-1,1)),href:"#"})}),Array.from({length:V},(e,s)=>t.jsx(C.nt,{children:t.jsx(C.kN,{isActive:E===s+1,onClick:()=>P(s+1),href:"#",children:s+1})},s)),t.jsx(C.nt,{children:t.jsx(C.$0,{onClick:()=>P(e=>Math.min(e+1,V)),href:"#"})})]})})]})]}),t.jsx(x.Vq,{open:r,onOpenChange:O,children:(0,t.jsxs)(x.cZ,{children:[t.jsx(x.fK,{children:t.jsx(x.$N,{children:y?"Update Device":"Add New Device"})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx(o._,{children:"Device Name"}),t.jsx(d.I,{value:q.profile.name,onChange:e=>T({...q,profile:{...q.profile,name:e.target.value}})})]}),(0,t.jsxs)("div",{children:[t.jsx(o._,{children:"Part Number"}),(0,t.jsxs)(A.Ph,{value:q.profile.part_number,onValueChange:e=>T({...q,profile:{...q.profile,part_number:e}}),children:[t.jsx(A.i4,{children:t.jsx(A.ki,{placeholder:"Select a part number"})}),(0,t.jsxs)(A.Bw,{children:[t.jsx(A.Ql,{value:"RELAYMINI",children:"RELAYMINI"}),t.jsx(A.Ql,{value:"RELAY",children:"RELAY"}),t.jsx(A.Ql,{value:"DRYCONTACT",children:"DRYCONTACT"}),t.jsx(A.Ql,{value:"DIGITALIO",children:"DIGITAL IO"})]})]})]}),(0,t.jsxs)("div",{children:[t.jsx(o._,{children:"Address"}),t.jsx(d.I,{value:q.protocol_setting.address,onChange:e=>T({...q,protocol_setting:{...q.protocol_setting,address:e.target.value}})})]}),(0,t.jsxs)("div",{children:[t.jsx(o._,{children:"Device Bus"}),t.jsx(d.I,{value:q.protocol_setting.device_bus,onChange:e=>T({...q,protocol_setting:{...q.protocol_setting,device_bus:e.target.value}})})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[t.jsx(o._,{children:"Topic"}),t.jsx(d.I,{value:q.profile.topic,onChange:e=>T({...q,profile:{...q.profile,topic:e.target.value}})})]}),t.jsx(n.z,{onClick:()=>{let e=JSON.stringify({command:y?"updateDevice":"addDevice",device:q});M?.publish("command_device_i2c",e),O(!1)},className:"col-span-2",children:y?"Update Device":"Add Device"})]})]})})]})}},32451:(e,s,r)=>{"use strict";r.d(s,{_:()=>d});var t=r(30784),i=r(9885),l=r(43618),n=r(91971),a=r(98699);let c=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef(({className:e,...s},r)=>t.jsx(l.f,{ref:r,className:(0,a.cn)(c(),e),...s}));d.displayName=l.f.displayName},69415:(e,s,r)=>{"use strict";r.r(s),r.d(s,{$$typeof:()=>n,__esModule:()=>l,default:()=>c});var t=r(95153);let i=(0,t.createProxy)(String.raw`D:\Alfi\RnD\IOT\DEVELOPMENT\App-Nodes\app\devices\modular\page.tsx`),{__esModule:l,$$typeof:n}=i,a=i.default,c=a}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[5075,7783,6482,5247,6007,5425,9039,7803,983,754,599,1890,3892,7640,516,7578,9121],()=>__webpack_exec__(2706));module.exports=r})();