(()=>{var e={};e.id=9826,e.ids=[9826],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},19882:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>o});var r=t(67096),a=t(16132),n=t(37284),i=t.n(n),l=t(32564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let o=["",{children:["payload",{children:["dynamic",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,9e4)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\payload\\dynamic\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,35345)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,38196)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,44293)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\not-found.tsx"]}],d=["D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\payload\\dynamic\\page.tsx"],u="/payload/dynamic/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/payload/dynamic/page",pathname:"/payload/dynamic",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},66059:(e,s,t)=>{Promise.resolve().then(t.bind(t,60357))},60357:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>CustomPayloadPage});var r=t(30784),a=t(9885),n=t(36482),i=t.n(n),l=t(9941),c=t(31362),o=t(73928),d=t(95555),u=t(40516),p=t(33770),m=t(54108),x=t(74050),h=t(90391),y=t(26303),v=t(80774),j=t(46544),g=t(13422),f=t(99491),_=t(94112),k=t(47917),N=t(21145);function CustomPayloadPage(){let[e,s]=(0,a.useState)("disconnected"),[t,n]=(0,a.useState)(null),[b,C]=(0,a.useState)([]),[S,D]=(0,a.useState)(!1),[E,O]=(0,a.useState)(null),[P,q]=(0,a.useState)(""),[A,w]=(0,a.useState)(!1),[z,T]=(0,a.useState)(0),[M,I]=(0,a.useState)(10),[Z,R]=(0,a.useState)([{name:"",keyOptions:[],value_keys:[{key:"",value:""}]}]),V=(0,a.useRef)();(0,a.useEffect)(()=>{let e=i().connect("ws://localhost:9000");return e.on("connect",()=>{s("connected"),e.subscribe("config/device_info/response"),e.subscribe("config/summary_device/response"),e.publish("config/device_info",JSON.stringify({command:"getDeviceInfo"}))}),e.on("error",()=>s("error")),e.on("close",()=>s("disconnected")),e.on("message",(e,s)=>{let t=JSON.parse(s.toString());e.endsWith("/device_info/response")&&C(t),e.endsWith("/summary_device/response")&&n(t)}),V.current=e,()=>{e.end()}},[]),(0,a.useEffect)(()=>{b.length&&N.Z.get("/devices.json").then(e=>{let s={};Object.entries(e.data).forEach(([e,t])=>{t.forEach(e=>{s[e.name]=e.data.map(e=>e.var_name)})}),C(b.map(e=>({...e,keyOptions:s[e.name]||[]})))})},[b.length]);let openEditor=e=>{if(void 0!==e&&t){let s=t.groups[e];q(s.summary_topic),w(s.retain),T(s.qos),I(s.interval),R(s.included_devices.map(e=>({...e,keyOptions:b.find(s=>s.name===e.name)?.keyOptions||[]}))),O(e)}else q(""),w(!1),T(0),I(10),R([{name:"",keyOptions:[],value_keys:[{key:"",value:""}]}]),O(null);D(!0)},deleteGroup=e=>{let s=t?.groups[e].summary_topic;V.current?.publish("config/summary_device",JSON.stringify({command:"deleteData",data:{summary_topic:s}})),l.Am.success("Deleted"),V.current?.publish("config/summary_device",JSON.stringify({command:"getData"}))},{searchQuery:L,setSearchQuery:G,filteredData:J}=(0,f.d)(t?.groups||[],["summary_topic"]),{sorted:K,sortField:$,sortDirection:B,handleSort:F}=(0,_.E)(J),[Q,W]=(0,a.useState)(1),X=Math.ceil(K.length/10),H=K.slice((Q-1)*10,10*Q);return(0,r.jsxs)(c.kV,{children:[(0,r.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(c.vP,{}),r.jsx(o.Z,{orientation:"vertical",className:"h-4"}),r.jsx(m.Z,{className:"w-5 h-5 text-muted-foreground"}),r.jsx("h1",{className:"text-lg font-semibold",children:"Custom Payload Data"})]}),r.jsx(j.Z,{})]}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-wrap justify-between items-center mb-4 gap-2",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(d.z,{size:"sm",variant:"secondary",onClick:()=>V.current?.publish("config/summary_device",JSON.stringify({command:"getData"})),children:"Get Data"}),r.jsx(d.z,{size:"sm",variant:"default",onClick:()=>openEditor(),children:"Create New Data"})]}),r.jsx("input",{type:"text",placeholder:"Search...",className:"border rounded px-2 py-1 w-64",value:L,onChange:e=>G(e.target.value)})]}),(0,r.jsxs)(g.iA,{children:[r.jsx(g.xD,{children:(0,r.jsxs)(g.SC,{children:[(0,r.jsxs)(g.ss,{onClick:()=>F("summary_topic"),className:"cursor-pointer select-none",children:["Topic ",r.jsx(x.Z,{className:"inline w-4 h-4 ml-1 align-middle"})]}),r.jsx(g.ss,{children:"Devices"}),(0,r.jsxs)(g.ss,{onClick:()=>F("retain"),className:"cursor-pointer select-none",children:["Retain ",r.jsx(x.Z,{className:"inline w-4 h-4 ml-1 align-middle"})]}),(0,r.jsxs)(g.ss,{onClick:()=>F("qos"),className:"cursor-pointer select-none",children:["QoS ",r.jsx(x.Z,{className:"inline w-4 h-4 ml-1 align-middle"})]}),(0,r.jsxs)(g.ss,{onClick:()=>F("interval"),className:"cursor-pointer select-none",children:["Interval ",r.jsx(x.Z,{className:"inline w-4 h-4 ml-1 align-middle"})]}),r.jsx(g.ss,{children:"Actions"})]})}),r.jsx(g.RM,{children:H.length?H.map((e,s)=>(0,r.jsxs)(g.SC,{children:[r.jsx(g.pj,{children:e.summary_topic}),r.jsx(g.pj,{children:e.included_devices.map(e=>e.name).join(", ")}),r.jsx(g.pj,{children:e.retain?"✔️":"❌"}),r.jsx(g.pj,{children:e.qos}),(0,r.jsxs)(g.pj,{children:[e.interval,"s"]}),(0,r.jsxs)(g.pj,{children:[r.jsx(d.z,{size:"icon",onClick:()=>openEditor(s),children:r.jsx(h.Z,{})}),r.jsx(d.z,{size:"icon",variant:"destructive",onClick:()=>deleteGroup(s),children:r.jsx(y.Z,{})})]})]},s)):r.jsx(g.SC,{children:r.jsx(g.pj,{colSpan:6,className:"text-center text-muted-foreground py-8",children:'Tidak ada data konfigurasi custom payload. Klik "Add Data" untuk menambah konfigurasi baru.'})})})]}),r.jsx(k.tl,{className:"mt-4",children:(0,r.jsxs)(k.ng,{children:[r.jsx(k.dN,{onClick:()=>W(e=>Math.max(1,e-1))}),Array.from({length:X},(e,s)=>r.jsx(k.nt,{children:r.jsx(k.kN,{isActive:Q===s+1,onClick:()=>W(s+1),children:s+1})},s)),r.jsx(k.$0,{onClick:()=>W(e=>Math.min(X,e+1))})]})}),r.jsx(u.Vq,{open:S,onOpenChange:D,children:(0,r.jsxs)(u.cZ,{children:[r.jsx(u.fK,{children:r.jsx(u.$N,{children:null===E?"Add Custom Payload":"Edit Custom Payload"})}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(p.I,{placeholder:"Summary Topic",value:P,onChange:e=>q(e.target.value)}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(p.I,{placeholder:"QoS",type:"number",value:z,onChange:e=>T(Number(e.target.value))}),r.jsx(p.I,{placeholder:"Interval",type:"number",value:M,onChange:e=>I(Number(e.target.value))}),(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",checked:A,onChange:e=>w(e.target.checked)})," Retain"]})]}),Z.map((e,s)=>(0,r.jsxs)("div",{className:"space-y-1 border p-2",children:[(0,r.jsxs)("select",{className:"border rounded p-1",value:e.name,onChange:e=>{let t=[...Z];t[s].name=e.target.value,t[s].keyOptions=b.find(s=>s.name===e.target.value)?.keyOptions||[],R(t)},children:[r.jsx("option",{value:"",children:"Select Device"}),b.map(e=>r.jsx("option",{value:e.name,children:e.name},e.name))]}),e.value_keys.map((t,a)=>(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("select",{className:"border rounded p-1",value:t.key,onChange:e=>{let t=[...Z];t[s].value_keys[a].key=e.target.value,R(t)},children:[r.jsx("option",{value:"",children:"Key"}),e.keyOptions.map(e=>r.jsx("option",{children:e},e))]}),r.jsx(p.I,{placeholder:"Value",value:t.value,onChange:e=>{let t=[...Z];t[s].value_keys[a].value=e.target.value,R(t)}}),r.jsx(d.z,{variant:"destructive",size:"icon",onClick:()=>{let e=[...Z];e[s].value_keys.splice(a,1),R(e)},children:"\xd7"})]},a)),r.jsx(d.z,{size:"sm",variant:"secondary",onClick:()=>{let e=[...Z];e[s].value_keys.push({key:"",value:""}),R(e)},children:"Add Key"})]},s)),(0,r.jsxs)(d.z,{size:"sm",variant:"secondary",onClick:()=>R([...Z,{name:"",keyOptions:[],value_keys:[{key:"",value:""}]}]),children:[r.jsx(v.Z,{})," Add Device"]})]}),r.jsx(u.cN,{children:r.jsx(d.z,{onClick:()=>{let e={command:null===E?"writeData":"updateData",data:{summary_topic:P,retain:A,qos:z,interval:M,included_devices:Z.map(e=>({name:e.name,value_group:e.value_group,value_keys:Object.fromEntries(e.value_keys.map(e=>[e.key,e.value]))}))}};V.current?.publish("config/summary_device",JSON.stringify(e)),D(!1),l.Am.success("Summary saved"),V.current?.publish("config/summary_device",JSON.stringify({command:"getData"}))},children:"Save"})})]})})]})]})}},99491:(e,s,t)=>{"use strict";t.d(s,{d:()=>useSearchFilter});var r=t(9885);function getValueByKeyPath(e,s){let t=s.split("."),r=e;for(let e of t){if(!r||"object"!=typeof r)return"";r=r[e]}return String(r??"")}function useSearchFilter(e,s){let[t,a]=(0,r.useState)(""),n=(0,r.useMemo)(()=>{if(!t)return e;let r=t.toLowerCase();return e.filter(e=>s.some(s=>getValueByKeyPath(e,s).toLowerCase().includes(r)))},[t,e,s]);return{searchQuery:t,setSearchQuery:a,filteredData:n}}},9e4:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>n,default:()=>c});var r=t(95153);let a=(0,r.createProxy)(String.raw`D:\Alfi\RnD\IOT\DEVELOPMENT\App-Nodes\app\payload\dynamic\page.tsx`),{__esModule:n,$$typeof:i}=a,l=a.default,c=l}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[5075,7783,6482,9941,8794,6007,1145,4537,754,1890,3892,7640,516,6544,7578],()=>__webpack_exec__(19882));module.exports=t})();