(()=>{var e={};e.id=6576,e.ids=[6576],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},57310:e=>{"use strict";e.exports=require("url")},78975:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>h,pages:()=>c,routeModule:()=>u,tree:()=>d});var n=t(67096),a=t(16132),l=t(37284),i=t.n(l),r=t(32564),o={};for(let e in r)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>r[e]);t.d(s,o);let d=["",{children:["control",{children:["geofence",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,27461)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\control\\geofence\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,35345)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,38196)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,44293)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\not-found.tsx"]}],c=["D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\control\\geofence\\page.tsx"],h="/control/geofence/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/control/geofence/page",pathname:"/control/geofence",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},89397:(e,s,t)=>{Promise.resolve().then(t.bind(t,79625))},79625:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>GeoRoutePage});var n=t(30784),a=t(9885),l=t(31362),i=t(73928),r=t(20599),o=t(95555),d=t(87094),c=t(70173),h=t(5987),x=t(84079),u=t(92269),p=t(60440),m=t(74614),g=t(10475),j=t(51899);t(6998);var f=t(40516),v=t(33770);let b=0;function genId(){return(b=(b+1)%Number.MAX_SAFE_INTEGER).toString()}let N=new Map,addToRemoveQueue=e=>{if(N.has(e))return;let s=setTimeout(()=>{N.delete(e),dispatch({type:"REMOVE_TOAST",toastId:e})},1e6);N.set(e,s)},reducer=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?addToRemoveQueue(t):e.toasts.forEach(e=>{addToRemoveQueue(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},y=[],_={toasts:[]};function dispatch(e){_=reducer(_,e),y.forEach(e=>{e(_)})}function toast({...e}){let s=genId(),dismiss=()=>dispatch({type:"DISMISS_TOAST",toastId:s});return dispatch({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:e=>{e||dismiss()}}}),{id:s,dismiss,update:e=>dispatch({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function useToast(){let[e,s]=a.useState(_);return a.useEffect(()=>(y.push(s),()=>{let e=y.indexOf(s);e>-1&&y.splice(e,1)}),[e]),{...e,toast,dismiss:e=>dispatch({type:"DISMISS_TOAST",toastId:e})}}function GeoRoutePage(){let e={lat:-6.3028,lng:106.8061,name:"Stadion GBK"},s={lat:-6.1754,lng:106.8272,name:"Monas"},[t,b]=(0,a.useState)(0),[N,y]=(0,a.useState)(0),[_,C]=(0,a.useState)([]),D=[(e.lat+s.lat)/2,(e.lng+s.lng)/2],T=(0,a.useRef)(),[A,E]=(0,a.useState)(!1),[I,O]=(0,a.useState)({device_id:"d11f3075-4e6d-45a5-a3ba-86e0e6298034",unique_name:"Alfi Maulana - Dev",area_id:"Area 1",lat:s.lat,long:s.lng,config:[{device:"relay_1",pin:1,address:32,bus:0,logic:!1},{device:"relay_1",pin:2,address:32,bus:0,logic:!0},{device:"relay_2",pin:1,address:33,bus:0,logic:!0}]}),{toast:S}=useToast();async function fetchRoute(){let t=`https://router.project-osrm.org/route/v1/driving/${e.lng},${e.lat};${s.lng},${s.lat}?overview=full&geometries=geojson`;try{let e=await fetch(t),s=await e.json(),n=s.routes?.[0];C(n.geometry.coordinates.map(e=>[e[1],e[0]])),b(Math.round(n.distance)),y(Math.round(n.duration))}catch(e){console.error(e),S({variant:"destructive",title:"Failed to load route"})}}let P=t<1e3?`${t} M`:`${(t/1e3).toFixed(2)} KM`,w=(()=>{let e=Math.floor(N/3600),s=Math.floor(N%3600/60),t=N%60;return e?`${e}h ${s}m ${t}s`:s?`${s}m ${t}s`:`${t}s`})(),removeGeoConfig=e=>{O(s=>({...s,config:s.config.filter((s,t)=>t!==e)}))},handleGeoformChange=(e,s)=>{O(t=>({...t,[e]:s}))},handleConfigChange=(e,s,t)=>{O(n=>({...n,config:n.config.map((n,a)=>a===e?{...n,[s]:t}:n)}))};return(0,n.jsxs)(l.kV,{children:[(0,n.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[n.jsx(l.vP,{}),n.jsx(i.Z,{orientation:"vertical",className:"h-4"}),n.jsx(d.Z,{className:"w-5 h-5 "}),n.jsx("h1",{className:"text-lg font-semibold",children:"Route & Geoâ€‘Fence"})]}),n.jsx(o.z,{size:"icon",variant:"outline",onClick:()=>fetchRoute(),children:n.jsx(c.Z,{className:"w-4 h-4"})})]}),(0,n.jsxs)("div",{className:"p-6 space-y-4 max-w-5xl mx-auto",children:[(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsx(r.Zb,{className:"shadow-md",children:(0,n.jsxs)(r.aY,{className:"space-y-2 pt-4",children:[n.jsx("h6",{className:"text-primary font-bold",children:"Route Info"}),(0,n.jsxs)("p",{children:[n.jsx("strong",{children:"Distance:"})," ",P]}),(0,n.jsxs)("p",{children:[n.jsx("strong",{children:"Duration:"})," ",w]}),(0,n.jsxs)("p",{children:[n.jsx("strong",{children:"Radius Virtual Boundaries:"})," ",1e3," m"]}),(0,n.jsxs)("div",{className:"flex gap-2 mt-2",children:[n.jsx(o.z,{variant:"outline",size:"sm",onClick:()=>{T.current?.flyTo(D,15)},children:"Focus to Route Center"}),(0,n.jsxs)(o.z,{variant:"secondary",size:"sm",onClick:()=>E(!0),children:[n.jsx(h.Z,{className:"w-4 h-4 mr-1"})," Config Geofencing Control"]})]})]})}),n.jsx(r.Zb,{className:"shadow-md",children:(0,n.jsxs)(r.aY,{className:"space-y-2 pt-4",children:[n.jsx("h6",{className:"text-success font-bold",children:"Location Info"}),(0,n.jsxs)("p",{children:[n.jsx("strong",{children:"Destination:"})," ",s.name]}),(0,n.jsxs)("p",{children:[n.jsx("strong",{children:"Lat:"})," ",s.lat]}),(0,n.jsxs)("p",{children:[n.jsx("strong",{children:"Long:"})," ",s.lng]}),n.jsx("hr",{className:"my-2"}),(0,n.jsxs)("p",{children:[n.jsx("strong",{children:"Current Location:"})," ",e.name]}),(0,n.jsxs)("p",{children:[n.jsx("strong",{children:"Lat:"})," ",e.lat]}),(0,n.jsxs)("p",{children:[n.jsx("strong",{children:"Long:"})," ",e.lng]})]})})]}),n.jsx(r.Zb,{className:"shadow-md",children:(0,n.jsxs)(r.aY,{className:"pt-4",children:[n.jsx("h6",{className:"text-success font-bold mb-3",children:"Geofencing Output Control"}),(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 mb-2",children:[(0,n.jsxs)("div",{children:[n.jsx("strong",{children:"Device ID:"})," ",I.device_id]}),(0,n.jsxs)("div",{children:[n.jsx("strong",{children:"Unique Name:"})," ",I.unique_name]}),(0,n.jsxs)("div",{children:[n.jsx("strong",{children:"Area ID:"})," ",I.area_id]}),(0,n.jsxs)("div",{children:[n.jsx("strong",{children:"Latitude:"})," ",I.lat]}),(0,n.jsxs)("div",{children:[n.jsx("strong",{children:"Longitude:"})," ",I.long]})]}),n.jsx("h6",{className:"text-secondary font-bold mt-4 mb-2",children:"Device Config"}),n.jsx("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"table-auto w-full text-sm border rounded",children:[n.jsx("thead",{children:(0,n.jsxs)("tr",{className:"bg-blue-50",children:[n.jsx("th",{className:"px-2 py-1",children:"#"}),n.jsx("th",{className:"px-2 py-1",children:"Device"}),n.jsx("th",{className:"px-2 py-1",children:"Pin"}),n.jsx("th",{className:"px-2 py-1",children:"Address"}),n.jsx("th",{className:"px-2 py-1",children:"Bus"}),n.jsx("th",{className:"px-2 py-1",children:"Logic"})]})}),n.jsx("tbody",{children:I.config.map((e,s)=>(0,n.jsxs)("tr",{className:"even:bg-blue-50",children:[n.jsx("td",{className:"px-2 py-1",children:s+1}),n.jsx("td",{className:"px-2 py-1",children:e.device}),n.jsx("td",{className:"px-2 py-1",children:e.pin}),n.jsx("td",{className:"px-2 py-1",children:e.address}),n.jsx("td",{className:"px-2 py-1",children:e.bus}),n.jsx("td",{className:"px-2 py-1",children:e.logic?"true":"false"})]},s))})]})})]})}),n.jsx("div",{className:"rounded-2xl border shadow-sm overflow-hidden mt-3",style:{height:"500px",width:"100%"},children:(0,n.jsxs)(x.h,{ref:T,center:D,zoom:12,style:{height:"100%",width:"100%"},children:[n.jsx(u.I,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),n.jsx(p.J,{position:[e.lat,e.lng],children:n.jsx(m.G,{children:e.name})}),n.jsx(p.J,{position:[s.lat,s.lng],children:n.jsx(m.G,{children:s.name})}),n.jsx(g.C,{center:[s.lat,s.lng],radius:1e3,pathOptions:{color:"green",fillOpacity:.3}}),_.length>0&&n.jsx(j.a,{positions:_,pathOptions:{color:"#5bc0de",weight:4}})]})}),n.jsx(f.Vq,{open:A,onOpenChange:E,children:n.jsx(f.cZ,{className:"max-w-2xl",children:(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),S({title:"Geofence config saved!",description:JSON.stringify(I,null,2)}),E(!1)},children:[n.jsx(f.fK,{children:n.jsx(f.$N,{children:"Geofencing Configuration"})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2",children:[(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-sm font-medium",children:"Device ID"}),n.jsx(v.I,{value:I.device_id,onChange:e=>handleGeoformChange("device_id",e.target.value),required:!0})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-sm font-medium",children:"Unique Name"}),n.jsx(v.I,{value:I.unique_name,onChange:e=>handleGeoformChange("unique_name",e.target.value),required:!0})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-sm font-medium",children:"Area ID"}),n.jsx(v.I,{value:I.area_id,onChange:e=>handleGeoformChange("area_id",e.target.value),required:!0})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-sm font-medium",children:"Latitude"}),n.jsx(v.I,{value:I.lat,readOnly:!0})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-sm font-medium",children:"Longitude"}),n.jsx(v.I,{value:I.long,readOnly:!0})]})]}),n.jsx("h6",{className:"mt-4 mb-2 font-bold",children:"Device Config"}),I.config.map((e,s)=>(0,n.jsxs)("div",{className:"border rounded p-3 mb-3 grid grid-cols-1 md:grid-cols-6 gap-2 items-end",children:[(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-xs",children:"Device"}),(0,n.jsxs)("select",{className:"w-full border rounded px-2 py-1",value:e.device,onChange:e=>handleConfigChange(s,"device",e.target.value),children:[n.jsx("option",{value:"relay_1",children:"relay_1"}),n.jsx("option",{value:"relay_2",children:"relay_2"})]})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-xs",children:"Pin"}),n.jsx(v.I,{type:"number",value:e.pin,onChange:e=>handleConfigChange(s,"pin",Number(e.target.value))})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-xs",children:"Address"}),n.jsx(v.I,{type:"number",value:e.address,onChange:e=>handleConfigChange(s,"address",Number(e.target.value))})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-xs",children:"Bus"}),n.jsx(v.I,{type:"number",value:e.bus,onChange:e=>handleConfigChange(s,"bus",Number(e.target.value))})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-xs",children:"Logic"}),(0,n.jsxs)("select",{className:"w-full border rounded px-2 py-1",value:e.logic?"true":"false",onChange:e=>handleConfigChange(s,"logic","true"===e.target.value),children:[n.jsx("option",{value:"true",children:"True"}),n.jsx("option",{value:"false",children:"False"})]})]}),n.jsx("div",{className:"flex justify-end",children:(0,n.jsxs)(o.z,{type:"button",variant:"destructive",size:"icon",onClick:()=>removeGeoConfig(s),children:[n.jsx("span",{className:"sr-only",children:"Remove"}),"\xd7"]})})]},s)),n.jsx(o.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{O(e=>({...e,config:[...e.config,{device:"relay_1",pin:1,address:32,bus:0,logic:!1}]}))},children:"+ Add Config"}),(0,n.jsxs)(f.cN,{className:"mt-4",children:[n.jsx(o.z,{type:"submit",variant:"default",children:"Save"}),n.jsx(o.z,{type:"button",variant:"secondary",onClick:()=>E(!1),children:"Cancel"})]})]})})})]})]})}},27461:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>l,default:()=>o});var n=t(95153);let a=(0,n.createProxy)(String.raw`D:\Alfi\RnD\IOT\DEVELOPMENT\App-Nodes\app\control\geofence\page.tsx`),{__esModule:l,$$typeof:i}=a,r=a.default,o=r}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[5075,7992,754,599,516],()=>__webpack_exec__(78975));module.exports=t})();