(()=>{var e={};e.id=4430,e.ids=[4430],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},85353:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c});var t=r(67096),i=r(16132),n=r(37284),a=r.n(n),o=r(32564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(s,l);let c=["",{children:["control",{children:["schedule",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,60897)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\control\\schedule\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,35345)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,38196)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,44293)),"D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\not-found.tsx"]}],d=["D:\\Alfi\\RnD\\IOT\\DEVELOPMENT\\App-Nodes\\app\\control\\schedule\\page.tsx"],u="/control/schedule/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/control/schedule/page",pathname:"/control/schedule",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},85155:(e,s,r)=>{Promise.resolve().then(r.bind(r,98671))},98671:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>SchedulerPage});var t=r(30784),i=r(9885),n=r(61890),a=r(95555),o=r(20599),l=r(73928),c=r(31362),d=r(18096),u=r(41129),p=r(90391),x=r(26303),m=r(92327),h=r(37640),f=r(73195),g=r(98699);let b=i.forwardRef(({className:e,...s},r)=>t.jsx(f.fC,{className:(0,g.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:r,children:t.jsx(f.bU,{className:(0,g.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));b.displayName=f.fC.displayName;var N=r(9941);function SchedulerPage(){let[e,s]=(0,i.useState)([]),[r,f]=(0,i.useState)(!1),g=(0,h.w)(),v=(0,m.k)();(0,i.useEffect)(()=>{if(!v)return;let handleMessage=(e,r)=>{try{let e=JSON.parse(r.toString());Array.isArray(e.devices)?(s(e.devices),f(e.autoControl)):e.result&&N.Am.success(e.message||"Operation successful")}catch(e){console.error("Failed to parse MQTT message",e),N.Am.error("MQTT parsing error")}};return v.on("message",handleMessage),v.subscribe("response_control_scheduler"),v.publish("command_control_scheduler",JSON.stringify({action:"get"})),()=>{v.unsubscribe("response_control_scheduler"),v.off("message",handleMessage)}},[v]);let deleteDevice=e=>{v?.publish("command_control_scheduler",JSON.stringify({action:"delete",data:{id:e}})),s(s=>s.filter(s=>s.id!==e)),N.Am.success("Device deleted")};return(0,t.jsxs)(c.kV,{children:[(0,t.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(c.vP,{className:"-ml-1"}),t.jsx(l.Z,{orientation:"vertical",className:"mr-2 h-4"}),t.jsx(d.Z,{className:"h-5 w-5 text-muted-foreground"}),t.jsx("h1",{className:"text-lg font-semibold",children:"Scheduler Control"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(n.C,{variant:"outline",className:`capitalize ${"connected"===g?"text-green-600 border-green-600":"error"===g?"text-red-600 border-red-600":"text-yellow-600 border-yellow-600"}`,children:g}),t.jsx(a.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{v?.publish("command_control_scheduler",JSON.stringify({action:"get"}))},children:t.jsx(u.Z,{})})]})]}),(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-base font-semibold",children:"Control State"}),t.jsx(b,{checked:r,onCheckedChange:f,onBlur:()=>{v?.publish("command_control_scheduler",JSON.stringify({action:"update_autoControl",data:{autoControl:r}}))}})]}),e.length>0?e.map((e,s)=>(0,t.jsxs)(o.Zb,{children:[(0,t.jsxs)(o.Ol,{children:[t.jsx(o.ll,{className:"text-base",children:e.customName}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Address: ",e.address," — Bus: ",e.device_bus," — Days: ",e.startDay,"–",e.endDay]})]}),(0,t.jsxs)(o.aY,{className:"space-y-2",children:[e.controls.map(e=>(0,t.jsxs)("div",{className:"text-sm flex justify-between",children:[(0,t.jsxs)("span",{children:[t.jsx("strong",{children:e.customName})," (Pin ",e.pin,")"]}),(0,t.jsxs)("span",{children:["On: ",e.onTime," — Off: ",e.offTime]})]},e.pin)),(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,t.jsxs)(a.z,{size:"sm",variant:"outline",children:[t.jsx(p.Z,{className:"h-4 w-4 mr-1"})," Edit"]}),(0,t.jsxs)(a.z,{size:"sm",variant:"destructive",onClick:()=>deleteDevice(e.id),children:[t.jsx(x.Z,{className:"h-4 w-4 mr-1"})," Delete"]})]})]})]},e.id)):t.jsx(o.Zb,{children:t.jsx(o.aY,{className:"p-4 text-center text-muted-foreground",children:"No scheduler devices found."})})]})]})}},60897:(e,s,r)=>{"use strict";r.r(s),r.d(s,{$$typeof:()=>a,__esModule:()=>n,default:()=>l});var t=r(95153);let i=(0,t.createProxy)(String.raw`D:\Alfi\RnD\IOT\DEVELOPMENT\App-Nodes\app\control\schedule\page.tsx`),{__esModule:n,$$typeof:a}=i,o=i.default,l=o}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[5075,7783,6482,9941,3599,754,599,1890,3892,7640],()=>__webpack_exec__(85353));module.exports=r})();