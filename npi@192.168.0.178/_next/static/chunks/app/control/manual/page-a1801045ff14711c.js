(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4502],{4530:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3157:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},9806:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},5458:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]])},7216:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},9670:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3715:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3086:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]])},1827:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6714:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]])},4631:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(5531);let s=(0,n.Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2741:function(e,t,r){Promise.resolve().then(r.bind(r,3549))},3549:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return DeviceManagerPage}});var n=r(7437),s=r(2265),a=r(708),o=r(3611),c=r(9598),i=r(5831),l=r(307),d=r(5458),u=r(3086),f=r(6714),m=r(1827),h=r(7216),g=r(9670),p=r(3157),x=r(9806),b=r(5217),v=r(5344),y=r(9719),j=r(6577),N=r(5744),w=r(3763),k=r(9790),T="Toggle",M=s.forwardRef((e,t)=>{let{pressed:r,defaultPressed:s,onPressedChange:a,...o}=e,[c,i]=(0,w.T)({prop:r,onChange:a,defaultProp:s??!1,caller:T});return(0,n.jsx)(k.WV.button,{type:"button","aria-pressed":c,"data-state":c?"on":"off","data-disabled":e.disabled?"":void 0,...o,ref:t,onClick:(0,N.M)(e.onClick,()=>{e.disabled||i(!c)})})});M.displayName=T;var _=r(6061),C=r(1628);let Z=(0,_.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),S=s.forwardRef((e,t)=>{let{className:r,variant:s,size:a,...o}=e;return(0,n.jsx)(M,{ref:t,className:(0,C.cn)(Z({variant:s,size:a,className:r})),...o})});function DeviceManagerPage(){let[e,t]=(0,s.useState)([]),[r,N]=(0,s.useState)(null),[w,k]=(0,s.useState)({}),[T,M]=(0,s.useState)({}),_=(0,s.useRef)(null);(0,s.useEffect)(()=>{_.current||(_.current=(0,v.kS)());let e=_.current;if(!e){console.warn("MQTT client not available.");return}let handleMessage=(e,r)=>{try{let n=r.toString(),s=JSON.parse(n);"response_device_i2c"===e?Array.isArray(s)?(t(s),M(e=>{let t={...e};return s.forEach(e=>{void 0===t[e.profile.topic]&&(t[e.profile.topic]=!0)}),Object.keys(t).forEach(e=>{s.some(t=>t.profile.topic===e)||delete t[e]}),t})):console.warn("[MQTT] DeviceManagerPage (I2C): Payload from response_device_i2c is not an array, skipping update:",s):"mqtt_broker_server"===e?(console.log("[MQTT] Received mqtt_broker_server payload:",s),N(s)):k(t=>({...t,[e]:s}))}catch(t){console.error("[MQTT] DeviceManagerPage: Invalid JSON from MQTT topic '".concat(e,"' or processing error:"),t,"Raw message:",r.toString())}};return e.on("message",handleMessage),e.subscribe("response_device_i2c"),e.subscribe("mqtt_broker_server",{qos:1}),e.publish("command_device_i2c",JSON.stringify({command:"getDataI2C"})),()=>{e.unsubscribe("response_device_i2c"),e.unsubscribe("mqtt_broker_server"),e.off("message",handleMessage)}},[]),(0,s.useEffect)(()=>{let t=_.current;if(!t)return;let r=new Set(Object.keys(w)),n=new Set(e.map(e=>e.profile.topic));return r.forEach(e=>{n.has(e)||"response_device_i2c"===e||"mqtt_broker_server"===e||(t.unsubscribe(e),k(t=>{let r={...t};return delete r[e],r}),M(t=>{let r={...t};return delete r[e],r}),console.log("[MQTT] Unsubscribed from: ".concat(e)))}),n.forEach(e=>{r.has(e)||(t.subscribe(e,{qos:0}),console.log("[MQTT] Subscribed to: ".concat(e)))}),()=>{n.forEach(e=>{t.unsubscribe(e),console.log("[MQTT] Unsubscribed from: ".concat(e," (cleanup)"))})}},[e,w]);let{searchQuery:Z,setSearchQuery:Q,filteredData:O}=(0,y.d)(e,["profile.name","profile.part_number","profile.topic","protocol_setting.address"]),handleToggleChange=(e,t,n)=>{if(!_.current||!r){console.warn("MQTT client not available or broker data missing.");return}let s=t.match(/\d+/),a=s?parseInt(s[0],10):0,o={mac:r.mac_address,protocol_type:"Modular",device:"RELAYMINI",function:"write",value:{pin:a,data:n?1:0},address:e.protocol_setting.address,device_bus:e.protocol_setting.device_bus,Timestamp:new Date().toISOString().slice(0,19).replace("T"," ")},c="modular";_.current.publish(c,JSON.stringify(o)),console.log("[MQTT] Sending command to ".concat(c,": ").concat(JSON.stringify(o))),k(r=>{let s=r[e.profile.topic];if(s)try{let a=JSON.parse(s.value);if("object"==typeof a&&null!==a)return a[t]=n,{...r,[e.profile.topic]:{...s,value:JSON.stringify(a)}}}catch(e){console.error("Error updating optimistic UI:",e)}return r})},toggleLiveDataVisibility=e=>{M(t=>({...t,[e]:!t[e]}))};return(0,n.jsxs)(l.kV,{children:[(0,n.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.vP,{className:"-ml-1"}),(0,n.jsx)(b.Z,{orientation:"vertical",className:"mr-2 h-4"}),(0,n.jsx)(d.Z,{className:"h-5 w-5"}),(0,n.jsx)("h1",{className:"text-lg font-semibold",children:"Modular Devices Monitoring"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(j.Z,{}),(0,n.jsx)(o.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{var e;null===(e=_.current)||void 0===e||e.publish("command_device_i2c",JSON.stringify({command:"getDataI2C"}))},children:(0,n.jsx)(u.Z,{})})]})]}),(0,n.jsxs)(c.Zb,{className:"m-4",children:[(0,n.jsx)(c.Ol,{children:(0,n.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(f.Z,{className:"h-5 w-5"})," MQTT Broker Server Info"]})}),(0,n.jsx)(c.aY,{children:r?(0,n.jsx)("div",{className:"bg-card text-card-foreground rounded-lg shadow-sm p-4 border",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[(0,n.jsxs)("div",{className:"col-span-2",children:[(0,n.jsx)("span",{className:"font-medium",children:"MAC:"})," ",r.mac_address]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Broker Address:"})," ",r.broker_address]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Broker Port:"})," ",r.broker_port]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Broker Username:"})," ",r.username||"-"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Broker Password:"})," ",r.password?"********":"-"]})]})}):(0,n.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No broker server data received yet."})})]}),(0,n.jsxs)(c.Zb,{className:"m-4",children:[(0,n.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between",children:[(0,n.jsx)(c.ll,{children:"Connected Devices"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(m.Z,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,n.jsx)(i.I,{placeholder:"Search devices by name, part number, topic, or address...",value:Z,onChange:e=>Q(e.target.value),className:"pl-8 h-8 w-64"})]})]}),(0,n.jsx)(c.aY,{children:O.length>0?(0,n.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:O.map(e=>{let t=w[e.profile.topic],r=T[e.profile.topic],s=null;if(t&&"string"==typeof t.value)try{s=JSON.parse(t.value)}catch(t){console.error("Error parsing value for topic ".concat(e.profile.topic,":"),t)}let i=!("RELAY"===e.profile.part_number||"RELAYMINI"===e.profile.part_number);return(0,n.jsxs)(c.Zb,{className:"border-l-4 border-green-500 shadow-sm",children:[(0,n.jsxs)(c.Ol,{className:"pb-2",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)(c.ll,{className:"text-lg font-semibold truncate",children:e.profile.name}),(0,n.jsx)(o.z,{variant:"ghost",size:"icon",onClick:()=>toggleLiveDataVisibility(e.profile.topic),className:"h-7 w-7",children:r?(0,n.jsx)(h.Z,{className:"h-4 w-4"}):(0,n.jsx)(g.Z,{className:"h-4 w-4"})})]}),(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:["PN: ",e.profile.part_number]})]}),(0,n.jsxs)(c.aY,{className:"text-sm",children:[(0,n.jsxs)("p",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Address:"}),(0,n.jsx)(a.C,{variant:"secondary",children:e.protocol_setting.address})]}),(0,n.jsxs)("p",{className:"flex justify-between items-center mt-1",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Bus:"}),(0,n.jsx)(a.C,{variant:"secondary",children:e.protocol_setting.device_bus})]}),(0,n.jsxs)("p",{className:"flex justify-between items-center mt-1",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Topic:"}),(0,n.jsx)(a.C,{variant:"secondary",className:"max-w-[150px] truncate",children:e.profile.topic})]}),r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b.Z,{className:"my-2"}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Live Data:"}),t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center col-span-2 text-sm",children:[(0,n.jsx)("span",{className:"font-medium",children:"Timestamp:"}),(0,n.jsx)(a.C,{variant:"outline",className:"text-foreground",children:t.Timestamp})]}),s?(0,n.jsx)("div",{className:"grid grid-cols-2 gap-1 text-sm mt-2",children:Object.entries(s).map(t=>{let[r,s]=t,a=r.match(/\d+/),o=a?"Input ".concat(a[0]):r;return r.startsWith("drycontactInput")&&"boolean"==typeof s?(0,n.jsxs)("div",{className:"flex justify-between items-center col-span-2",children:[(0,n.jsxs)("span",{className:"font-medium",children:[o,":"]}),(0,n.jsx)(S,{pressed:s,"aria-label":"Toggle ".concat(o," status"),onPressedChange:t=>handleToggleChange(e,r,t),size:"sm",className:(0,C.cn)("data-[state=on]:bg-green-500 data-[state=off]:bg-red-500","data-[state=on]:text-white data-[state=off]:text-white","w-20 h-7 flex items-center justify-center text-xs gap-1"),disabled:i,children:s?(0,n.jsxs)(n.Fragment,{children:["ON ",(0,n.jsx)(p.Z,{className:"h-4 w-4"})]}):(0,n.jsxs)(n.Fragment,{children:["OFF ",(0,n.jsx)(x.Z,{className:"h-4 w-4"})]})})]},r):null})}):(0,n.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Value data not available or malformed."})]}):(0,n.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"No live data yet."})]})]})]},e.profile.topic)})}):(0,n.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No devices found matching your search."})})]})]})}S.displayName=M.displayName},6577:function(e,t,r){"use strict";r.d(t,{Z:function(){return MQTTConnectionBadge}});var n=r(7437),s=r(9035),a=r(708),o=r(4530),c=r(4631),i=r(9806),l=r(3715);function MQTTConnectionBadge(){let e=(0,s.w)(),{color:t,icon:r,label:d}=(()=>{switch(e){case"connected":return{color:"bg-green-500",icon:(0,n.jsx)(o.Z,{className:"w-4 h-4 mr-1"}),label:"Connected"};case"disconnected":return{color:"bg-yellow-500",icon:(0,n.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),label:"Disconnected"};case"error":return{color:"bg-red-500",icon:(0,n.jsx)(i.Z,{className:"w-4 h-4 mr-1"}),label:"Error"};default:return{color:"bg-gray-400",icon:(0,n.jsx)(l.Z,{className:"w-4 h-4 mr-1 animate-spin"}),label:"Connecting..."}}})();return(0,n.jsxs)(a.C,{className:"flex items-center ".concat(t," text-white px-2 py-1"),children:[r,(0,n.jsx)("span",{className:"text-sm",children:d})]})}},708:function(e,t,r){"use strict";r.d(t,{C:function(){return Badge}});var n=r(7437);r(2265);var s=r(6061),a=r(1628);let o=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-400 text-yellow-900 hover:bg-yellow-500",outline:"bg-transparent border-foreground text-foreground",outlineInfo:"bg-transparent border-blue-500 text-blue-600",outlineSuccess:"bg-transparent border-green-500 text-green-600",outlineWarning:"bg-transparent border-yellow-400 text-yellow-700",outlineDestructive:"bg-transparent border-destructive text-destructive",gradientInfo:"border-0 bg-gradient-to-r from-blue-400/50 to-blue-600/50 text-blue-900",gradientSuccess:"border-0 bg-gradient-to-r from-green-400/50 to-green-600/50 text-green-900",gradientWarning:"border-0 bg-gradient-to-r from-yellow-300/50 to-yellow-500/50 text-yellow-900",gradientDestructive:"border-0 bg-gradient-to-r from-red-400/50 to-red-600/50 text-red-900"}},defaultVariants:{variant:"default"}});function Badge(e){let{className:t,variant:r,...s}=e;return(0,n.jsx)("div",{className:(0,a.cn)(o({variant:r}),t),...s})}},9598:function(e,t,r){"use strict";r.d(t,{Ol:function(){return c},SZ:function(){return l},Zb:function(){return o},aY:function(){return d},eW:function(){return u},ll:function(){return i}});var n=r(7437),s=r(2265),a=r(1628);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});o.displayName="Card";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...s})});c.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});i.displayName="CardTitle";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...s})});l.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},9719:function(e,t,r){"use strict";r.d(t,{d:function(){return useSearchFilter}});var n=r(2265);function getValueByKeyPath(e,t){let r=t.split("."),n=e;for(let e of r){if(!n||"object"!=typeof n)return"";n=n[e]}return String(null!=n?n:"")}function useSearchFilter(e,t){let[r,s]=(0,n.useState)(""),a=(0,n.useMemo)(()=>{if(!r)return e;let n=r.toLowerCase();return e.filter(e=>t.some(t=>getValueByKeyPath(e,t).toLowerCase().includes(n)))},[r,e,t]);return{searchQuery:r,setSearchQuery:s,filteredData:a}}},9035:function(e,t,r){"use strict";r.d(t,{w:function(){return useMQTTStatus}});var n=r(2265),s=r(5344);function useMQTTStatus(){let e=(0,s.Oh)(),[t,r]=(0,n.useState)(()=>e?e.connected?"connected":e.disconnected?"disconnected":"connecting":"connecting");return(0,n.useEffect)(()=>{let e=(0,s.kS)();e.connected?r("connected"):e.disconnected?r("disconnected"):r("connecting");let handleConnect=()=>r("connected"),handleError=()=>r("error"),handleClose=()=>r("disconnected"),handleReconnect=()=>r("connecting"),handleOffline=()=>r("disconnected");return e.on("connect",handleConnect),e.on("error",handleError),e.on("close",handleClose),e.on("reconnect",handleReconnect),e.on("offline",handleOffline),()=>{e.off("connect",handleConnect),e.off("error",handleError),e.off("close",handleClose),e.off("reconnect",handleReconnect),e.off("offline",handleOffline)}},[]),t}},5344:function(e,t,r){"use strict";r.d(t,{kS:function(){return connectMQTT},Oh:function(){return getMQTTClient}});var n=r(7406);function getAppConfig(){let e,t;let r=window.location.protocol;if("https:"===r?(e="ws://192.168.0.106:9000",t="http://192.168.0.100:8000"):(e="ws://".concat(window.location.hostname,":9000"),t="http://".concat(window.location.hostname,":8000")),!e)throw Error("MQTT broker URL is not defined.");if(!t)throw Error("API base URL is not defined.");return{mqttBrokerUrl:e,apiBaseUrl:t}}let s=null,a=!1;function connectMQTT(){let{mqttBrokerUrl:e}=getAppConfig();if(!e)throw Error("MQTT broker URL is missing from configuration.");if(s&&(s.connected||a))return s;if(!s||s.disconnected){if(a)return s;a=!0,console.log("MQTT: Attempting connection to ".concat(e,"...")),(s=n.Z.connect(e,{clean:!0,connectTimeout:3e3,reconnectPeriod:1e3})).on("connect",()=>{console.log("MQTT: Connected to ".concat(e)),a=!1}),s.on("error",e=>{console.error("MQTT Error: ".concat(e.message)),a=!1}),s.on("reconnect",()=>{console.log("MQTT: Reconnecting to ".concat(e)),a=!0}),s.on("close",()=>{console.log("MQTT: Connection to ".concat(e," closed.")),a=!1}),s.on("offline",()=>{console.log("MQTT: Client is offline."),a=!1})}return s}function getMQTTClient(){return s}}},function(e){e.O(0,[2793,9848,5348,307,2971,2472,1744],function(){return e(e.s=2741)}),_N_E=e.O()}]);