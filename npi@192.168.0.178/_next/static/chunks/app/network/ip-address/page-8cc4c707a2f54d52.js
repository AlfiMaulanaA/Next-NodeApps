(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[720],{4530:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5531);let o=(0,r.Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9806:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5531);let o=(0,r.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1392:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5531);let o=(0,r.Z)("network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]])},3086:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5531);let o=(0,r.Z)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]])},6245:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5531);let o=(0,r.Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},4631:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5531);let o=(0,r.Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},261:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5531);let o=(0,r.Z)("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]])},8772:function(e,t,n){Promise.resolve().then(n.bind(n,4273))},4273:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return NetworkPage}});var r=n(7437),o=n(2265),a=n(5344),s=n(1424),i=n(6820),c=n.n(i),d=n(2031),l=n(5831),u=n(3611),m=n(5217),f=n(307),g=n(9598),h=n(1392),p=n(3715),x=n(3086),w=n(6245),y=n(261),b=n(6577);let N="command_device_ip",k="response_device_ip",v="service/command",j="service/response";function NetworkPage(){let[e,t]=(0,o.useState)(null),[n,i]=(0,o.useState)({address:"",netmask:"",gateway:""}),[C,T]=(0,o.useState)(!1),P=(0,o.useRef)(null),[I,M]=(0,o.useState)(!0),[A,Z]=(0,o.useState)(502),isValidIP=e=>/^(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}$/.test(e),isValidNetmask=e=>{let t=e.split(".").map(Number);return!(4!==t.length||t.some(e=>e<0||e>255))&&["255.255.255.255","255.255.255.254","255.255.255.252","255.255.255.248","255.255.255.240","255.255.255.224","255.255.255.192","255.255.255.128","255.255.255.0","255.255.254.0","255.255.252.0","255.255.248.0","255.255.240.0","255.255.224.0","255.255.192.0","255.255.128.0","255.255.0.0","255.254.0.0","255.252.0.0","255.248.0.0","255.240.0.0","255.224.0.0","255.192.0.0","255.128.0.0","255.0.0.0","0.0.0.0"].includes(e)},handleInput=(e,t)=>{i(n=>({...n,[e]:t}))},S=(0,o.useCallback)(()=>{let e=(0,a.Oh)();e&&e.connected?(M(!0),setTimeout(()=>{e.publish(N,JSON.stringify({command:"readIP",interface:"eth0"}),{},e=>{e?(s.Am.error("Failed to request config: ".concat(e.message)),console.error("Publish error (readIP command):",e),M(!1)):s.Am.info("Requesting network configuration...")})},300)):(s.Am.warning("MQTT not connected. Cannot request network configuration."),M(!1))},[]),Q=(0,o.useCallback)(async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v,o=arguments.length>4?arguments[4]:void 0,a=P.current;if(!a||!a.connected){s.Am.error("MQTT not connected. Please wait for connection or refresh.");return}let i=!0;if(n){let e=await c().fire({title:"Are you sure?",text:n,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, proceed!"});e.isConfirmed||(i=!1,s.Am.info("Action cancelled."))}if(i){let n;let i="serviceCommand";if(o)n=o;else if(r===v)n={services:[e],action:t};else if(r===N&&"restartNetworking"===t)n={command:"restartNetworking"},i="networkRestart";else{console.warn("Unhandled payload construction scenario for sendCommandToService.");return}a.publish(r,JSON.stringify(n),{},n=>{n?(s.Am.dismiss(i),s.Am.error("Failed to send command: ".concat(n.message)),console.error("Publish error to ".concat(r,":"),n)):s.Am.loading("".concat(t.toUpperCase()," ").concat(e," initiated..."),{id:i})})}},[]),updateConfig=async()=>{if(!isValidIP(n.address)||!isValidIP(n.gateway)||!isValidNetmask(n.netmask)){s.Am.error("Invalid input format for IP Address, Netmask, or Gateway. Please check values.");return}let e=(0,a.Oh)();if(!e||!e.connected){s.Am.error("MQTT not connected. Cannot update configuration.");return}let t=await c().fire({title:"Apply Network Changes?",html:"Changing network settings will require the **device to reboot** to apply the changes. This may temporarily disconnect the device. Are you sure you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, update and reboot!",cancelButtonText:"Cancel"});if(!t.isConfirmed){s.Am.info("Network update cancelled.");return}M(!0),s.Am.loading("Sending configuration update...",{id:"networkUpdate"});let r=n.address,o={command:"changeIP",interface:"eth0",method:"static",static_ip:r,netmask:n.netmask,gateway:n.gateway};e.publish(N,JSON.stringify(o),{},t=>{t?(s.Am.dismiss("networkUpdate"),c().fire({position:"top-end",icon:"error",title:"Failed to send update command: ".concat(t.message),showConfirmButton:!1,timer:3e3,toast:!0}),M(!1)):(T(!1),e.publish("IOT/Containment/modbustcp/setting/command",JSON.stringify({command:"write",modbus_tcp_ip:r,modbus_tcp_port:A}),{},e=>{e?(console.error("Failed to publish new IP to Modbus TCP:",e),s.Am.error("Failed to update Modbus TCP IP. Check manually after network change.")):console.log("Published new IP to Modbus TCP successfully.")}),e.publish("IOT/Containment/snmp/setting/command",JSON.stringify({command:"write",snmpIPaddress:r}),{},e=>{e?(console.error("Failed to publish new IP to SNMP:",e),s.Am.error("Failed to update SNMP IP. Check manually after network change.")):console.log("Published new IP to SNMP successfully.")}))})};return(0,o.useEffect)(()=>{let e=(0,a.kS)();P.current=e;let n=[k,j];n.forEach(t=>{e.subscribe(t,e=>{e&&console.error("Failed to subscribe to ".concat(t,":"),e)})}),e.connected&&S();let handleConnect=()=>{n.forEach(t=>{e.subscribe(t,e=>{e&&console.error("Failed to re-subscribe to ".concat(t," on connect:"),e)})}),S(),s.Am.success("MQTT Connected for Network settings. Fetching data...")},handleMessage=(e,n)=>{try{let r=JSON.parse(n.toString());console.log("Received message on topic ".concat(e,":"),r),e===k?(s.Am.dismiss("networkUpdate"),s.Am.dismiss("networkRestart"),"success"===r.status?r.data&&r.data.eth0?(t(r.data.eth0),i(r.data.eth0),c().fire({position:"top-end",icon:"success",title:"Network configuration loaded!",showConfirmButton:!1,timer:1500,toast:!0})):"changeIP"===r.command?c().fire({position:"top-end",icon:"success",title:r.message||"Change IP command successful!",html:r.restart_networking?"Device rebooting or network restarting to apply changes...":"",showConfirmButton:!1,timer:5e3,toast:!0}):"restartNetworking"===r.command&&(c().fire({position:"top-end",icon:"success",title:r.message||"Network service restarted successfully!",showConfirmButton:!1,timer:3e3,toast:!0}),setTimeout(()=>{S()},2e3)):"error"===r.status&&c().fire({position:"top-end",icon:"error",title:r.message||"Network operation failed!",showConfirmButton:!1,timer:3e3,toast:!0}),M(!1)):e===j&&(s.Am.dismiss("serviceCommand"),"success"===r.result?(c().fire({position:"top-end",icon:"success",title:r.message||"Service command executed successfully!",showConfirmButton:!1,timer:3e3,toast:!0}),setTimeout(()=>{S()},2e3)):c().fire({position:"top-end",icon:"error",title:"Error!",text:r.message||"Failed to execute service command.",showConfirmButton:!1,timer:3e3,toast:!0}))}catch(e){s.Am.error("Invalid response from MQTT. Check backend payload."),console.error("Error parsing MQTT message:",n.toString(),e),M(!1)}};return e.on("connect",handleConnect),e.on("message",handleMessage),e.on("error",e=>{console.error("MQTT Client connection error:",e),s.Am.error("MQTT connection error. Please check broker settings."),M(!1)}),()=>{P.current&&(n.forEach(e=>{var t;null===(t=P.current)||void 0===t||t.unsubscribe(e)}),P.current.off("connect",handleConnect),P.current.off("message",handleMessage),P.current.off("error",()=>{}))}},[S,Q]),(0,r.jsxs)(f.kV,{children:[(0,r.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(f.vP,{className:"-ml-1"}),(0,r.jsx)(m.Z,{orientation:"vertical",className:"h-4"}),(0,r.jsx)(h.Z,{className:"w-5 h-5 text-primary"}),(0,r.jsx)("h1",{className:"text-lg font-semibold tracking-tight",children:"Network Configuration"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(b.Z,{}),(0,r.jsx)(u.z,{variant:"outline",size:"icon",onClick:S,disabled:I,children:I?(0,r.jsx)(p.Z,{className:"w-4 h-4 animate-spin"}):(0,r.jsx)(x.Z,{className:"w-4 h-4"})})]})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)(g.Zb,{children:[(0,r.jsx)(g.Ol,{children:(0,r.jsx)(g.ll,{children:"IP Configuration (eth0)"})}),(0,r.jsx)(g.aY,{children:I&&!e?(0,r.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center justify-center py-8",children:[(0,r.jsx)(p.Z,{className:"w-5 h-5 mr-2 animate-spin text-blue-500"}),"Fetching network data..."]}):e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("table",{className:"text-sm w-full",children:(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"font-medium pr-4 py-1",children:"IP Address"}),(0,r.jsx)("td",{className:"py-1",children:e.address})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"font-medium pr-4 py-1",children:"Netmask"}),(0,r.jsx)("td",{className:"py-1",children:e.netmask})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"font-medium pr-4 py-1",children:"Gateway"}),(0,r.jsx)("td",{className:"py-1",children:e.gateway})]})]})}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4",children:[(0,r.jsxs)(d.Vq,{open:C,onOpenChange:T,children:[(0,r.jsx)(d.hg,{asChild:!0,children:(0,r.jsx)(u.z,{size:"sm",variant:"default",disabled:I,children:"Edit IP"})}),(0,r.jsxs)(d.cZ,{children:[(0,r.jsx)(d.fK,{children:(0,r.jsx)(d.$N,{children:"Edit IP Configuration"})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(l.I,{placeholder:"IP Address",value:n.address,onChange:e=>handleInput("address",e.target.value),className:isValidIP(n.address)||""===n.address?"":"border-red-500"}),!isValidIP(n.address)&&""!==n.address&&(0,r.jsx)("p",{className:"text-xs text-red-500",children:"Invalid IP Address format (e.g., 192.168.1.1)."}),(0,r.jsx)(l.I,{placeholder:"Netmask",value:n.netmask,onChange:e=>handleInput("netmask",e.target.value),className:isValidNetmask(n.netmask)||""===n.netmask?"":"border-red-500"}),!isValidNetmask(n.netmask)&&""!==n.netmask&&(0,r.jsx)("p",{className:"text-xs text-red-500",children:"Invalid Netmask format (e.g., 255.255.255.0)."}),(0,r.jsx)(l.I,{placeholder:"Gateway",value:n.gateway,onChange:e=>handleInput("gateway",e.target.value),className:isValidIP(n.gateway)||""===n.gateway?"":"border-red-500"}),!isValidIP(n.gateway)&&""!==n.gateway&&(0,r.jsx)("p",{className:"text-xs text-red-500",children:"Invalid Gateway IP Address format (e.g., 192.168.1.254)."}),(0,r.jsxs)(u.z,{onClick:updateConfig,disabled:I||!isValidIP(n.address)||!isValidIP(n.gateway)||!isValidNetmask(n.netmask),className:"w-full",children:[I?(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2 animate-spin"}):(0,r.jsx)(w.Z,{className:"w-4 h-4 mr-2"})," Save Changes"]})]})]})]}),(0,r.jsxs)(u.z,{size:"sm",variant:"secondary",onClick:()=>{Q("networking.service","restart","Are you sure you want to restart the networking service? This will temporarily disrupt network connectivity. If you've just changed IP, a full reboot is recommended.")},disabled:I,children:[I?(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2 animate-spin"}):(0,r.jsx)(y.Z,{className:"w-4 h-4 mr-2"})," Restart Networking"]})]})]}):(0,r.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center justify-center py-8",children:[(0,r.jsx)(h.Z,{className:"w-5 h-5 mr-2"}),"No network configuration loaded. Ensure MQTT is connected and try refreshing."]})})]})})]})}},6577:function(e,t,n){"use strict";n.d(t,{Z:function(){return MQTTConnectionBadge}});var r=n(7437),o=n(9035),a=n(708),s=n(4530),i=n(4631),c=n(9806),d=n(3715);function MQTTConnectionBadge(){let e=(0,o.w)(),{color:t,icon:n,label:l}=(()=>{switch(e){case"connected":return{color:"bg-green-500",icon:(0,r.jsx)(s.Z,{className:"w-4 h-4 mr-1"}),label:"Connected"};case"disconnected":return{color:"bg-yellow-500",icon:(0,r.jsx)(i.Z,{className:"w-4 h-4 mr-1"}),label:"Disconnected"};case"error":return{color:"bg-red-500",icon:(0,r.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),label:"Error"};default:return{color:"bg-gray-400",icon:(0,r.jsx)(d.Z,{className:"w-4 h-4 mr-1 animate-spin"}),label:"Connecting..."}}})();return(0,r.jsxs)(a.C,{className:"flex items-center ".concat(t," text-white px-2 py-1"),children:[n,(0,r.jsx)("span",{className:"text-sm",children:l})]})}},708:function(e,t,n){"use strict";n.d(t,{C:function(){return Badge}});var r=n(7437);n(2265);var o=n(6061),a=n(1628);let s=(0,o.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-400 text-yellow-900 hover:bg-yellow-500",outline:"bg-transparent border-foreground text-foreground",outlineInfo:"bg-transparent border-blue-500 text-blue-600",outlineSuccess:"bg-transparent border-green-500 text-green-600",outlineWarning:"bg-transparent border-yellow-400 text-yellow-700",outlineDestructive:"bg-transparent border-destructive text-destructive",gradientInfo:"border-0 bg-gradient-to-r from-blue-400/50 to-blue-600/50 text-blue-900",gradientSuccess:"border-0 bg-gradient-to-r from-green-400/50 to-green-600/50 text-green-900",gradientWarning:"border-0 bg-gradient-to-r from-yellow-300/50 to-yellow-500/50 text-yellow-900",gradientDestructive:"border-0 bg-gradient-to-r from-red-400/50 to-red-600/50 text-red-900"}},defaultVariants:{variant:"default"}});function Badge(e){let{className:t,variant:n,...o}=e;return(0,r.jsx)("div",{className:(0,a.cn)(s({variant:n}),t),...o})}},9598:function(e,t,n){"use strict";n.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return s},aY:function(){return l},eW:function(){return u},ll:function(){return c}});var r=n(7437),o=n(2265),a=n(1628);let s=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...o})});s.displayName="Card";let i=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",n),...o})});i.displayName="CardHeader";let c=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",n),...o})});c.displayName="CardTitle";let d=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",n),...o})});d.displayName="CardDescription";let l=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",n),...o})});l.displayName="CardContent";let u=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",n),...o})});u.displayName="CardFooter"},2031:function(e,t,n){"use strict";n.d(t,{$N:function(){return f},Be:function(){return g},Vq:function(){return c},cN:function(){return DialogFooter},cZ:function(){return m},fK:function(){return DialogHeader},hg:function(){return d}});var r=n(7437),o=n(2265),a=n(8712),s=n(2549),i=n(1628);let c=a.fC,d=a.xz,l=a.h_;a.x8;let u=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)(a.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...o})});u.displayName=a.aV.displayName;let m=o.forwardRef((e,t)=>{let{className:n,children:o,...c}=e;return(0,r.jsxs)(l,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(a.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...c,children:[o,(0,r.jsxs)(a.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(s.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=a.VY.displayName;let DialogHeader=e=>{let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...n})};DialogHeader.displayName="DialogHeader";let DialogFooter=e=>{let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n})};DialogFooter.displayName="DialogFooter";let f=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)(a.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",n),...o})});f.displayName=a.Dx.displayName;let g=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)(a.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",n),...o})});g.displayName=a.dk.displayName},9035:function(e,t,n){"use strict";n.d(t,{w:function(){return useMQTTStatus}});var r=n(2265),o=n(5344);function useMQTTStatus(){let e=(0,o.Oh)(),[t,n]=(0,r.useState)(()=>e?e.connected?"connected":e.disconnected?"disconnected":"connecting":"connecting");return(0,r.useEffect)(()=>{let e=(0,o.kS)();e.connected?n("connected"):e.disconnected?n("disconnected"):n("connecting");let handleConnect=()=>n("connected"),handleError=()=>n("error"),handleClose=()=>n("disconnected"),handleReconnect=()=>n("connecting"),handleOffline=()=>n("disconnected");return e.on("connect",handleConnect),e.on("error",handleError),e.on("close",handleClose),e.on("reconnect",handleReconnect),e.on("offline",handleOffline),()=>{e.off("connect",handleConnect),e.off("error",handleError),e.off("close",handleClose),e.off("reconnect",handleReconnect),e.off("offline",handleOffline)}},[]),t}},5344:function(e,t,n){"use strict";n.d(t,{kS:function(){return connectMQTT},Oh:function(){return getMQTTClient}});var r=n(7406);function getAppConfig(){let e,t;let n=window.location.protocol;if("https:"===n?(e="ws://192.168.0.106:9000",t="http://192.168.0.100:8000"):(e="ws://".concat(window.location.hostname,":9000"),t="http://".concat(window.location.hostname,":8000")),!e)throw Error("MQTT broker URL is not defined.");if(!t)throw Error("API base URL is not defined.");return{mqttBrokerUrl:e,apiBaseUrl:t}}let o=null,a=!1;function connectMQTT(){let{mqttBrokerUrl:e}=getAppConfig();if(!e)throw Error("MQTT broker URL is missing from configuration.");if(o&&(o.connected||a))return o;if(!o||o.disconnected){if(a)return o;a=!0,console.log("MQTT: Attempting connection to ".concat(e,"...")),(o=r.Z.connect(e,{clean:!0,connectTimeout:3e3,reconnectPeriod:1e3})).on("connect",()=>{console.log("MQTT: Connected to ".concat(e)),a=!1}),o.on("error",e=>{console.error("MQTT Error: ".concat(e.message)),a=!1}),o.on("reconnect",()=>{console.log("MQTT: Reconnecting to ".concat(e)),a=!0}),o.on("close",()=>{console.log("MQTT: Connection to ".concat(e," closed.")),a=!1}),o.on("offline",()=>{console.log("MQTT: Client is offline."),a=!1})}return o}function getMQTTClient(){return o}}},function(e){e.O(0,[2793,9461,9848,5348,6107,307,2971,2472,1744],function(){return e(e.s=8772)}),_N_E=e.O()}]);