(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4800],{3863:function(e,n,r){Promise.resolve().then(r.bind(r,659))},659:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return WifiScannerPage}});var t=r(7437),s=r(2265),o=r(1424),c=r(307),i=r(5217),a=r(1750),l=r(9598),d=r(3611),u=r(5831),f=r(261),g=r(4280),h=r(3922),m=r(6232),x=r(5367),b=r(5344),p=r(6577);function WifiScannerPage(){let[e,n]=(0,s.useState)("disconnected"),[r,w]=(0,s.useState)([]),[v,j]=(0,s.useState)("scan"),[N,y]=(0,s.useState)(""),[S,C]=(0,s.useState)(""),[T,k]=(0,s.useState)(""),M=(0,s.useRef)();(0,s.useEffect)(()=>{let e=(0,b.kS)();M.current=e;let handleConnect=()=>{n("connected"),e.subscribe("wifi/scan_results"),e.subscribe("wifi/ip_update")},handleError=()=>n("error"),handleClose=()=>n("disconnected"),handleMessage=(e,n)=>{try{let r=JSON.parse(n.toString());"wifi/scan_results"===e?(w(r.networks||[]),o.Am.success("Wi-Fi scan complete")):"wifi/ip_update"===e&&"success"===r.status?o.Am.success("Switched to ".concat(r.ssid,", new IP: ").concat(r.ip)):"error"===r.status&&o.Am.error(r.message||"An error occurred.")}catch(e){o.Am.error("Invalid data received"),console.error("MQTT message parsing error:",e)}};return e.on("connect",handleConnect),e.on("error",handleError),e.on("close",handleClose),e.on("message",handleMessage),()=>{e.connected&&(e.unsubscribe("wifi/scan_results"),e.unsubscribe("wifi/ip_update")),e.off("connect",handleConnect),e.off("error",handleError),e.off("close",handleClose),e.off("message",handleMessage)}},[]);let signalColor=e=>e>=60?"text-green-600":e>=30?"text-orange-500":"text-red-600";return(0,t.jsxs)(c.kV,{children:[(0,t.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.vP,{className:"-ml-1"}),(0,t.jsx)(i.Z,{orientation:"vertical",className:"h-4"}),(0,t.jsx)(f.Z,{className:"w-5 h-5 text-muted-foreground"}),(0,t.jsx)("h1",{className:"text-lg font-semibold",children:"Wi‑Fi Scanner"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{}),(0,t.jsx)(d.z,{variant:"outline",size:"icon",onClick:()=>window.location.reload(),children:(0,t.jsx)(g.Z,{className:"w-4 h-4"})})]})]}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)(a.mQ,{defaultValue:"scan",value:v,onValueChange:j,className:"space-y-4",children:[(0,t.jsxs)(a.dr,{children:[(0,t.jsxs)(a.SP,{value:"scan",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 mr-1"})," Scan"]}),(0,t.jsxs)(a.SP,{value:"switch",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 mr-1"})," Switch Wi‑Fi"]}),(0,t.jsxs)(a.SP,{value:"delete",children:[(0,t.jsx)(x.Z,{className:"w-4 h-4 mr-1"})," Delete Wi‑Fi"]})]}),(0,t.jsx)(a.nU,{value:"scan",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{children:"Nearby Networks"})}),(0,t.jsxs)(l.aY,{children:[(0,t.jsx)(d.z,{onClick:()=>{var e;null===(e=M.current)||void 0===e||e.publish("wifi/scan_request","{}",e=>{e&&o.Am.error("Failed to request scan: ".concat(e.message))})},children:"Start Scan"}),(0,t.jsx)("div",{className:"mt-4",children:0===r.length?(0,t.jsx)("p",{children:"No networks found."}):(0,t.jsxs)("table",{className:"w-full table-fixed text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"text-left",children:"SSID"}),(0,t.jsx)("th",{className:"text-left",children:"Signal"})]})}),(0,t.jsx)("tbody",{children:r.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e.ssid}),(0,t.jsx)("td",{className:signalColor(e.signal_strength),children:e.signal_strength})]},e.ssid))})]})})]})]})}),(0,t.jsx)(a.nU,{value:"switch",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{children:"Switch Wi‑Fi"})}),(0,t.jsxs)(l.aY,{className:"space-y-3",children:[(0,t.jsxs)("select",{value:N,onChange:e=>y(e.target.value),className:"w-full border rounded px-2 py-1",children:[(0,t.jsx)("option",{value:"",children:"Select SSID"}),r.map(e=>(0,t.jsxs)("option",{value:e.ssid,children:[e.ssid," (",e.signal_strength,")"]},e.ssid))]}),(0,t.jsx)(u.I,{type:"password",placeholder:"Password",value:S,onChange:e=>C(e.target.value)}),(0,t.jsx)(d.z,{onClick:()=>{var e;if(!N||!S){o.Am.error("SSID & password required");return}null===(e=M.current)||void 0===e||e.publish("wifi/switch_wifi",JSON.stringify({ssid:N,password:S}),e=>{e?o.Am.error("Failed to switch Wi-Fi: ".concat(e.message)):o.Am.success("Switching to ".concat(N,"..."))})},children:"Switch"})]})]})}),(0,t.jsx)(a.nU,{value:"delete",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{children:"Delete Wi‑Fi"})}),(0,t.jsxs)(l.aY,{className:"space-y-3",children:[(0,t.jsx)(u.I,{placeholder:"SSID to delete",value:T,onChange:e=>k(e.target.value)}),(0,t.jsx)(d.z,{variant:"destructive",onClick:()=>{var e;if(!T){o.Am.error("SSID required");return}null===(e=M.current)||void 0===e||e.publish("wifi/delete_wifi",JSON.stringify({ssid:T}),e=>{e?o.Am.error("Failed to delete Wi-Fi: ".concat(e.message)):o.Am.success("Deleted ".concat(T))})},children:"Delete"})]})]})})]})})]})}},6577:function(e,n,r){"use strict";r.d(n,{Z:function(){return MQTTConnectionBadge}});var t=r(7437),s=r(9035),o=r(708),c=r(4530),i=r(4631),a=r(9806),l=r(3715);function MQTTConnectionBadge(){let e=(0,s.w)(),{color:n,icon:r,label:d}=(()=>{switch(e){case"connected":return{color:"bg-green-500",icon:(0,t.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),label:"Connected"};case"disconnected":return{color:"bg-yellow-500",icon:(0,t.jsx)(i.Z,{className:"w-4 h-4 mr-1"}),label:"Disconnected"};case"error":return{color:"bg-red-500",icon:(0,t.jsx)(a.Z,{className:"w-4 h-4 mr-1"}),label:"Error"};default:return{color:"bg-gray-400",icon:(0,t.jsx)(l.Z,{className:"w-4 h-4 mr-1 animate-spin"}),label:"Connecting..."}}})();return(0,t.jsxs)(o.C,{className:"flex items-center ".concat(n," text-white px-2 py-1"),children:[r,(0,t.jsx)("span",{className:"text-sm",children:d})]})}},708:function(e,n,r){"use strict";r.d(n,{C:function(){return Badge}});var t=r(7437);r(2265);var s=r(6061),o=r(1628);let c=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-400 text-yellow-900 hover:bg-yellow-500",outline:"bg-transparent border-foreground text-foreground",outlineInfo:"bg-transparent border-blue-500 text-blue-600",outlineSuccess:"bg-transparent border-green-500 text-green-600",outlineWarning:"bg-transparent border-yellow-400 text-yellow-700",outlineDestructive:"bg-transparent border-destructive text-destructive",gradientInfo:"border-0 bg-gradient-to-r from-blue-400/50 to-blue-600/50 text-blue-900",gradientSuccess:"border-0 bg-gradient-to-r from-green-400/50 to-green-600/50 text-green-900",gradientWarning:"border-0 bg-gradient-to-r from-yellow-300/50 to-yellow-500/50 text-yellow-900",gradientDestructive:"border-0 bg-gradient-to-r from-red-400/50 to-red-600/50 text-red-900"}},defaultVariants:{variant:"default"}});function Badge(e){let{className:n,variant:r,...s}=e;return(0,t.jsx)("div",{className:(0,o.cn)(c({variant:r}),n),...s})}},9598:function(e,n,r){"use strict";r.d(n,{Ol:function(){return i},SZ:function(){return l},Zb:function(){return c},aY:function(){return d},eW:function(){return u},ll:function(){return a}});var t=r(7437),s=r(2265),o=r(1628);let c=s.forwardRef((e,n)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:n,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});c.displayName="Card";let i=s.forwardRef((e,n)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:n,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let a=s.forwardRef((e,n)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:n,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});a.displayName="CardTitle";let l=s.forwardRef((e,n)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:n,className:(0,o.cn)("text-sm text-muted-foreground",r),...s})});l.displayName="CardDescription";let d=s.forwardRef((e,n)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:n,className:(0,o.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent";let u=s.forwardRef((e,n)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:n,className:(0,o.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},1750:function(e,n,r){"use strict";r.d(n,{SP:function(){return l},dr:function(){return a},mQ:function(){return i},nU:function(){return d}});var t=r(7437),s=r(2265),o=r(7094),c=r(1628);let i=o.fC,a=s.forwardRef((e,n)=>{let{className:r,...s}=e;return(0,t.jsx)(o.aV,{ref:n,className:(0,c.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...s})});a.displayName=o.aV.displayName;let l=s.forwardRef((e,n)=>{let{className:r,...s}=e;return(0,t.jsx)(o.xz,{ref:n,className:(0,c.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...s})});l.displayName=o.xz.displayName;let d=s.forwardRef((e,n)=>{let{className:r,...s}=e;return(0,t.jsx)(o.VY,{ref:n,className:(0,c.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...s})});d.displayName=o.VY.displayName},9035:function(e,n,r){"use strict";r.d(n,{w:function(){return useMQTTStatus}});var t=r(2265),s=r(5344);function useMQTTStatus(){let e=(0,s.Oh)(),[n,r]=(0,t.useState)(()=>e?e.connected?"connected":e.disconnected?"disconnected":"connecting":"connecting");return(0,t.useEffect)(()=>{let e=(0,s.kS)();e.connected?r("connected"):e.disconnected?r("disconnected"):r("connecting");let handleConnect=()=>r("connected"),handleError=()=>r("error"),handleClose=()=>r("disconnected"),handleReconnect=()=>r("connecting"),handleOffline=()=>r("disconnected");return e.on("connect",handleConnect),e.on("error",handleError),e.on("close",handleClose),e.on("reconnect",handleReconnect),e.on("offline",handleOffline),()=>{e.off("connect",handleConnect),e.off("error",handleError),e.off("close",handleClose),e.off("reconnect",handleReconnect),e.off("offline",handleOffline)}},[]),n}},5344:function(e,n,r){"use strict";r.d(n,{kS:function(){return connectMQTT},Oh:function(){return getMQTTClient}});var t=r(7406);function getAppConfig(){let e,n;let r=window.location.protocol;if("https:"===r?(e="ws://192.168.0.106:9000",n="http://192.168.0.100:8000"):(e="ws://".concat(window.location.hostname,":9000"),n="http://".concat(window.location.hostname,":8000")),!e)throw Error("MQTT broker URL is not defined.");if(!n)throw Error("API base URL is not defined.");return{mqttBrokerUrl:e,apiBaseUrl:n}}let s=null,o=!1;function connectMQTT(){let{mqttBrokerUrl:e}=getAppConfig();if(!e)throw Error("MQTT broker URL is missing from configuration.");if(s&&(s.connected||o))return s;if(!s||s.disconnected){if(o)return s;o=!0,console.log("MQTT: Attempting connection to ".concat(e,"...")),(s=t.Z.connect(e,{clean:!0,connectTimeout:3e3,reconnectPeriod:1e3})).on("connect",()=>{console.log("MQTT: Connected to ".concat(e)),o=!1}),s.on("error",e=>{console.error("MQTT Error: ".concat(e.message)),o=!1}),s.on("reconnect",()=>{console.log("MQTT: Reconnecting to ".concat(e)),o=!0}),s.on("close",()=>{console.log("MQTT: Connection to ".concat(e," closed.")),o=!1}),s.on("offline",()=>{console.log("MQTT: Client is offline."),o=!1})}return s}function getMQTTClient(){return s}}},function(e){e.O(0,[2793,9848,5348,6107,24,307,2971,2472,1744],function(){return e(e.s=3863)}),_N_E=e.O()}]);